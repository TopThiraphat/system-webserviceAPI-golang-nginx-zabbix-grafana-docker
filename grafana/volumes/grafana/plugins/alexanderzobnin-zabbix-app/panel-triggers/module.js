/*! For license information please see module.js.LICENSE.txt */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","app/core/core","lodash","moment","react","react-dom"],((e,t,n,r,o,a,i,s,l)=>(()=>{var c={42:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var i=o.apply(null,n);i&&e.push(i)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},8772:(e,t,n)=>{"use strict";var r=n(331);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,a,i){if(i!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return n.PropTypes=n,n}},3615:(e,t,n)=>{e.exports=n(8772)()},331:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7644:t=>{"use strict";t.exports=e},3305:e=>{"use strict";e.exports=t},3545:e=>{"use strict";e.exports=n},7388:e=>{"use strict";e.exports=r},7294:e=>{"use strict";e.exports=o},5980:e=>{"use strict";e.exports=a},8283:e=>{"use strict";e.exports=i},2650:e=>{"use strict";e.exports=s},2729:e=>{"use strict";e.exports=l}},u={};function d(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return c[e](n,n.exports,d),n.exports}d.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return d.d(t,{a:t}),t},d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var p={};return(()=>{"use strict";d.r(p),d.d(p,{plugin:()=>Qt});var e,t,n,r,o,a,i,s,l,c=d(3305),u=d(5980),m=d.n(u),h=d(8283),g=d.n(h);(l=e||(e={})).Group="group",l.Host="host",l.Application="application",l.Macro="macro",l.ItemTag="itemTag",l.Item="item",l.ItemValues="itemValues",(s=t||(t={})).Problems="problems",s.Recent="recent",s.History="history";class f extends c.BusEventWithPayload{}function v(e,t){const n=function(e){const t=[];let n=!1,r=!1;let o="";return m().forEach(e,(e=>{'"'===e&&r?o+=e:'"'===e&&n?n=!1:'"'!==e||n?"["!==e||n?"]"!==e||n?","!==e||n||r?o+=e:(t.push(o),o=""):r=!1:r=!0:n=!0})),t.push(o),t}(t.substring(t.indexOf("[")+1,t.lastIndexOf("]")));for(let t=n.length;t>=1;t--)e=e.replace("$"+t,n[t-1]);return e}function b(e,t){try{const n=function(e){const t=/(^[\d]+)(y|M|w|d|h|m|s)/g.exec(e);return g().duration(Number(t[1]),t[2]).valueOf()}(t);return Date.now()-1e3*e.timestamp<n}catch(e){return!1}}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}o="zbx-query-updated",(r="type")in(n=f)?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,function(e){e.UserLogin="userLogin",e.Token="token"}(a||(a={})),function(e){e.AndOr="0",e.Or="2"}(i||(i={})),(()=>{const e={},t=(0,c.getValueFormats)();for(const n of t)for(const t of n.submenu){const n=t.value;e[n]=n}})();var E=d(2650),w=d.n(E),P=d(3545),C=d(7294),x=d(7644),S=d(42),k=d.n(S),N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function T(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}const O={get:function(e,t,n){if(!t)return e;var r=F(t),o=void 0;try{o=r.reduce((function(e,t){return e[t]}),e)}catch(e){}return void 0!==o?o:n},set:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[2],n=F(arguments[1]),r=void 0,o=e;(r=n.shift())&&n.length;)o[r]||(o[r]={}),o=o[r];return o[r]=t,e},takeRight:function(e,t){var n=t>e.length?0:e.length-t;return e.slice(n)},last:function(e){return e[e.length-1]},orderBy:function(e,t,n,r){return e.sort((function(e,o){for(var a=0;a<t.length;a+=1){var i=t[a],s=!1===n[a]||"desc"===n[a],l=i(e,o);if(l)return s?-l:l}return n[0]?e[r]-o[r]:o[r]-e[r]}))},range:function(e){for(var t=[],n=0;n<e;n+=1)t.push(e);return t},remove:function(e,t){return e.filter((function(n,r){return!!t(n)&&(e.splice(r,1),!0)}))},clone:function(e){try{return JSON.parse(JSON.stringify(e,(function(e,t){return"function"==typeof t?t.toString():t})))}catch(t){return e}},getFirstDefined:function(){for(var e=0;e<arguments.length;e+=1)if(void 0!==(arguments.length<=e?void 0:arguments[e]))return arguments.length<=e?void 0:arguments[e]},sum:function(e){return e.reduce((function(e,t){return e+t}),0)},makeTemplateComponent:function(e,t){if(!t)throw new Error("No displayName found for template component:",e);var n=function(t){var n=t.children,r=t.className,o=T(t,["children","className"]);return w().createElement("div",N({className:k()(e,r)},o),n)};return n.displayName=t,n},groupBy:function(e,t){return e.reduce((function(e,n,r){var o="function"==typeof t?t(n,r):n[t];return e[o]=z(e[o])?e[o]:[],e[o].push(n),e}),{})},isArray:z,splitProps:function(e){return{className:e.className,style:e.style,rest:T(e,["className","style"])||{}}},compactObject:function(e){var t={};return e&&Object.keys(e).map((function(n){return Object.prototype.hasOwnProperty.call(e,n)&&void 0!==e[n]&&void 0!==e[n]&&(t[n]=e[n]),!0})),t},isSortingDesc:function(e){return!("desc"!==e.sort&&!0!==e.desc&&!1!==e.asc)},normalizeComponent:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return function(e){return"function"==typeof e&&!!Object.getPrototypeOf(e).isReactComponent}(n=e)||function(e){return"function"==typeof e&&String(e).includes(".createElement")}(n)?w().createElement(e,t):"function"==typeof e?e(t):r},asPx:function(e){return e=Number(e),Number.isNaN(e)?null:e+"px"}};function z(e){return Array.isArray(e)}function F(e){return D(e).join(".").replace(/\[/g,".").replace(/\]/g,"").split(".")}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(z(e))for(var n=0;n<e.length;n+=1)D(e[n],t);else t.push(e);return t}var R=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var $=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(e){return w().createElement("button",B({type:"button"},e,{className:"-btn"}),e.children)},I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getSafePage=n.getSafePage.bind(n),n.changePage=n.changePage.bind(n),n.applyPage=n.applyPage.bind(n),n.state={page:e.page},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),$(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.page!==e.page&&this.setState({page:e.page})}},{key:"getSafePage",value:function(e){return Number.isNaN(e)&&(e=this.props.page),Math.min(Math.max(e,0),this.props.pages-1)}},{key:"changePage",value:function(e){e=this.getSafePage(e),this.setState({page:e}),this.props.page!==e&&this.props.onPageChange(e)}},{key:"applyPage",value:function(e){e&&e.preventDefault();var t=this.state.page;this.changePage(""===t?this.props.page:t)}},{key:"getPageJumpProperties",value:function(){var e=this;return{onKeyPress:function(t){13!==t.which&&13!==t.keyCode||e.applyPage()},onBlur:this.applyPage,value:""===this.state.page?"":this.state.page+1,onChange:function(t){var n=t.target.value,r=n-1;if(""===n)return e.setState({page:n});e.setState({page:e.getSafePage(r)})},inputType:""===this.state.page?"text":"number",pageJumpText:this.props.pageJumpText}}},{key:"render",value:function(){var e=this,t=this.props,n=t.pages,r=t.page,o=t.showPageSizeOptions,a=t.pageSizeOptions,i=t.pageSize,s=t.showPageJump,l=t.canPrevious,c=t.canNext,u=t.onPageSizeChange,d=t.className,p=t.PreviousComponent,m=t.NextComponent,h=t.renderPageJump,g=t.renderCurrentPage,f=t.renderTotalPagesCount,v=t.renderPageSizeOptions;return w().createElement("div",{className:k()(d,"-pagination"),style:this.props.style},w().createElement("div",{className:"-previous"},w().createElement(p,{onClick:function(){l&&e.changePage(r-1)},disabled:!l},this.props.previousText)),w().createElement("div",{className:"-center"},w().createElement("span",{className:"-pageInfo"},this.props.pageText," ",s?h(this.getPageJumpProperties()):g(r)," ",this.props.ofText," ",f(n)),o&&v({pageSize:i,rowsSelectorText:this.props.rowsSelectorText,pageSizeOptions:a,onPageSizeChange:u,rowsText:this.props.rowsText})),w().createElement("div",{className:"-next"},w().createElement(m,{onClick:function(){c&&e.changePage(r+1)},disabled:!c},this.props.nextText)))}}]),t}(E.Component);I.defaultProps={PreviousComponent:_,NextComponent:_,renderPageJump:function(e){var t=e.onChange,n=e.value,r=e.onBlur,o=e.onKeyPress,a=e.inputType,i=e.pageJumpText;return w().createElement("div",{className:"-pageJump"},w().createElement("input",{"aria-label":i,type:a,onChange:t,value:n,onBlur:r,onKeyPress:o}))},renderCurrentPage:function(e){return w().createElement("span",{className:"-currentPage"},e+1)},renderTotalPagesCount:function(e){return w().createElement("span",{className:"-totalPages"},e||1)},renderPageSizeOptions:function(e){var t=e.pageSize,n=e.pageSizeOptions,r=e.rowsSelectorText,o=e.onPageSizeChange,a=e.rowsText;return w().createElement("span",{className:"select-wrap -pageSizeOptions"},w().createElement("select",{"aria-label":r,onChange:function(e){return o(Number(e.target.value))},value:t},n.map((function(e,t){return w().createElement("option",{key:t,value:e},e+" "+a)}))))}};const W=I;var L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function G(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var K=function(){return{}};const V={data:[],resolveData:function(e){return e},loading:!1,showPagination:!0,showPaginationTop:!1,showPaginationBottom:!0,showPageSizeOptions:!0,pageSizeOptions:[5,10,20,25,50,100],defaultPage:0,defaultPageSize:20,showPageJump:!0,collapseOnSortingChange:!0,collapseOnPageChange:!0,collapseOnDataChange:!0,freezeWhenExpanded:!1,sortable:!0,multiSort:!0,resizable:!0,filterable:!1,defaultSortDesc:!1,defaultSorted:[],defaultFiltered:[],defaultResized:[],defaultExpanded:{},defaultFilterMethod:function(e,t,n){var r=e.pivotId||e.id;return void 0===t[r]||String(t[r]).startsWith(e.value)},defaultSortMethod:function(e,t,n){return t=null==t?"":t,(e="string"==typeof(e=null==e?"":e)?e.toLowerCase():e)>(t="string"==typeof t?t.toLowerCase():t)?1:e<t?-1:0},onPageChange:void 0,onPageSizeChange:void 0,onSortedChange:void 0,onFilteredChange:void 0,onResizedChange:void 0,onExpandedChange:void 0,pivotBy:void 0,pivotValKey:"_pivotVal",pivotIDKey:"_pivotID",subRowsKey:"_subRows",aggregatedKey:"_aggregated",nestingLevelKey:"_nestingLevel",originalKey:"_original",indexKey:"_index",groupedByPivotKey:"_groupedByPivot",onFetchData:function(){return null},className:"",style:{},getProps:K,getTableProps:K,getTheadGroupProps:K,getTheadGroupTrProps:K,getTheadGroupThProps:K,getTheadProps:K,getTheadTrProps:K,getTheadThProps:K,getTheadFilterProps:K,getTheadFilterTrProps:K,getTheadFilterThProps:K,getTbodyProps:K,getTrGroupProps:K,getTrProps:K,getTdProps:K,getTfootProps:K,getTfootTrProps:K,getTfootTdProps:K,getPaginationProps:K,getLoadingProps:K,getNoDataProps:K,getResizerProps:K,column:{Cell:void 0,Header:void 0,Footer:void 0,Aggregated:void 0,Pivot:void 0,PivotValue:void 0,Expander:void 0,Filter:void 0,Placeholder:void 0,sortable:void 0,resizable:void 0,filterable:void 0,show:!0,minWidth:100,minResizeWidth:11,className:"",style:{},getProps:K,aggregate:void 0,headerClassName:"",headerStyle:{},getHeaderProps:K,footerClassName:"",footerStyle:{},getFooterProps:K,filterMethod:void 0,filterAll:!1,sortMethod:void 0},expanderDefaults:{sortable:!1,resizable:!1,filterable:!1,width:35},pivotDefaults:{},previousText:"Previous",nextText:"Next",loadingText:"Loading...",noDataText:"No rows found",pageText:"Page",ofText:"of",rowsText:"rows",pageJumpText:"jump to page",rowsSelectorText:"rows per page",TableComponent:function(e){var t=e.children,n=e.className,r=G(e,["children","className"]);return w().createElement("div",L({className:k()("rt-table",n),role:"grid"},r),t)},TheadComponent:O.makeTemplateComponent("rt-thead","Thead"),TbodyComponent:O.makeTemplateComponent("rt-tbody","Tbody"),TrGroupComponent:function(e){var t=e.children,n=e.className,r=G(e,["children","className"]);return w().createElement("div",L({className:k()("rt-tr-group",n),role:"rowgroup"},r),t)},TrComponent:function(e){var t=e.children,n=e.className,r=G(e,["children","className"]);return w().createElement("div",L({className:k()("rt-tr",n),role:"row"},r),t)},ThComponent:function(e){var t=e.toggleSort,n=e.className,r=e.children,o=G(e,["toggleSort","className","children"]);return w().createElement("div",L({className:k()("rt-th",n),onClick:function(e){return t&&t(e)},role:"columnheader",tabIndex:"-1"},o),r)},TdComponent:function(e){e.toggleSort;var t=e.className,n=e.children,r=G(e,["toggleSort","className","children"]);return w().createElement("div",L({className:k()("rt-td",t),role:"gridcell"},r),n)},TfootComponent:O.makeTemplateComponent("rt-tfoot","Tfoot"),FilterComponent:function(e){var t=e.filter,n=e.onChange,r=e.column;return w().createElement("input",{type:"text",style:{width:"100%"},placeholder:r.Placeholder,value:t?t.value:"",onChange:function(e){return n(e.target.value)}})},ExpanderComponent:function(e){var t=e.isExpanded;return w().createElement("div",{className:k()("rt-expander",t&&"-open")},"•")},PivotValueComponent:function(e){var t=e.subRows,n=e.value;return w().createElement("span",null,n," ",t&&"("+t.length+")")},AggregatedComponent:function(e){var t=e.subRows,n=e.column,r=t.filter((function(e){return void 0!==e[n.id]})).map((function(e,r){return w().createElement("span",{key:r},e[n.id],r<t.length-1?", ":"")}));return w().createElement("span",null,r)},PivotComponent:void 0,PaginationComponent:W,PreviousComponent:void 0,NextComponent:void 0,LoadingComponent:function(e){var t=e.className,n=e.loading,r=e.loadingText,o=G(e,["className","loading","loadingText"]);return w().createElement("div",L({className:k()("-loading",{"-active":n},t)},o),w().createElement("div",{className:"-loading-inner"},r))},NoDataComponent:O.makeTemplateComponent("rt-noData","NoData"),ResizerComponent:O.makeTemplateComponent("rt-resizer","Resizer"),PadRowComponent:function(){return w().createElement("span",null," ")}};var U=d(3615),J=d.n(U);const q={data:J().any,loading:J().bool,showPagination:J().bool,showPaginationTop:J().bool,showPaginationBottom:J().bool,showPageSizeOptions:J().bool,pageSizeOptions:J().array,defaultPageSize:J().number,showPageJump:J().bool,collapseOnSortingChange:J().bool,collapseOnPageChange:J().bool,collapseOnDataChange:J().bool,freezeWhenExpanded:J().bool,sortable:J().bool,resizable:J().bool,filterable:J().bool,defaultSortDesc:J().bool,defaultSorted:J().array,defaultFiltered:J().array,defaultResized:J().array,defaultExpanded:J().object,defaultFilterMethod:J().func,defaultSortMethod:J().func,onPageChange:J().func,onPageSizeChange:J().func,onSortedChange:J().func,onFilteredChange:J().func,onResizedChange:J().func,onExpandedChange:J().func,pivotBy:J().array,pivotValKey:J().string,pivotIDKey:J().string,subRowsKey:J().string,aggregatedKey:J().string,nestingLevelKey:J().string,originalKey:J().string,indexKey:J().string,groupedByPivotKey:J().string,onFetchData:J().func,className:J().string,style:J().object,getProps:J().func,getTableProps:J().func,getTheadGroupProps:J().func,getTheadGroupTrProps:J().func,getTheadGroupThProps:J().func,getTheadProps:J().func,getTheadTrProps:J().func,getTheadThProps:J().func,getTheadFilterProps:J().func,getTheadFilterTrProps:J().func,getTheadFilterThProps:J().func,getTbodyProps:J().func,getTrGroupProps:J().func,getTrProps:J().func,getTdProps:J().func,getTfootProps:J().func,getTfootTrProps:J().func,getTfootTdProps:J().func,getPaginationProps:J().func,getLoadingProps:J().func,getNoDataProps:J().func,getResizerProps:J().func,columns:J().arrayOf(J().shape({Cell:J().oneOfType([J().element,J().string,J().func]),Header:J().oneOfType([J().element,J().string,J().func]),Footer:J().oneOfType([J().element,J().string,J().func]),Aggregated:J().oneOfType([J().element,J().string,J().func]),Pivot:J().oneOfType([J().element,J().string,J().func]),PivotValue:J().oneOfType([J().element,J().string,J().func]),Expander:J().oneOfType([J().element,J().string,J().func]),Filter:J().oneOfType([J().element,J().func]),sortable:J().bool,resizable:J().bool,filterable:J().bool,show:J().bool,minWidth:J().number,minResizeWidth:J().number,className:J().string,style:J().object,getProps:J().func,aggregate:J().func,headerClassName:J().string,headerStyle:J().object,getHeaderProps:J().func,footerClassName:J().string,footerStyle:J().object,getFooterProps:J().func,filterMethod:J().func,filterAll:J().bool,sortMethod:J().func})),expanderDefaults:J().shape({sortable:J().bool,resizable:J().bool,filterable:J().bool,width:J().number}),pivotDefaults:J().object,previousText:J().node,nextText:J().node,loadingText:J().node,noDataText:J().node,pageText:J().node,ofText:J().node,rowsText:J().node,pageJumpText:J().node,rowsSelectorText:J().node,TableComponent:J().elementType,TheadComponent:J().elementType,TbodyComponent:J().elementType,TrGroupComponent:J().elementType,TrComponent:J().elementType,ThComponent:J().elementType,TdComponent:J().elementType,TfootComponent:J().elementType,FilterComponent:J().elementType,ExpanderComponent:J().elementType,PivotValueComponent:J().elementType,AggregatedComponent:J().elementType,PivotComponent:J().elementType,PaginationComponent:J().elementType,PreviousComponent:J().elementType,NextComponent:J().elementType,LoadingComponent:J().elementType,NoDataComponent:J().elementType,ResizerComponent:J().elementType,PadRowComponent:J().elementType};var Y=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Q=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Z=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.getResolvedState=n.getResolvedState.bind(n),n.getDataModel=n.getDataModel.bind(n),n.getSortedData=n.getSortedData.bind(n),n.fireFetchData=n.fireFetchData.bind(n),n.getPropOrState=n.getPropOrState.bind(n),n.getStateOrProp=n.getStateOrProp.bind(n),n.filterData=n.filterData.bind(n),n.sortData=n.sortData.bind(n),n.getMinRows=n.getMinRows.bind(n),n.onPageChange=n.onPageChange.bind(n),n.onPageSizeChange=n.onPageSizeChange.bind(n),n.sortColumn=n.sortColumn.bind(n),n.filterColumn=n.filterColumn.bind(n),n.resizeColumnStart=n.resizeColumnStart.bind(n),n.resizeColumnEnd=n.resizeColumnEnd.bind(n),n.resizeColumnMoving=n.resizeColumnMoving.bind(n),n.state={page:e.defaultPage,pageSize:e.defaultPageSize,sorted:e.defaultSorted,expanded:e.defaultExpanded,filtered:e.defaultFiltered,resized:e.defaultResized,currentlyResizing:!1,skipNextSort:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Q(t,[{key:"render",value:function(){var e=this,t=this.getResolvedState(),n=t.children,r=t.className,o=t.style,a=t.getProps,i=t.getTableProps,s=t.getTheadGroupProps,l=t.getTheadGroupTrProps,c=t.getTheadGroupThProps,u=t.getTheadProps,d=t.getTheadTrProps,p=t.getTheadThProps,m=t.getTheadFilterProps,h=t.getTheadFilterTrProps,g=t.getTheadFilterThProps,f=t.getTbodyProps,v=t.getTrGroupProps,b=t.getTrProps,y=t.getTdProps,E=t.getTfootProps,P=t.getTfootTrProps,C=t.getTfootTdProps,x=t.getPaginationProps,S=t.getLoadingProps,N=t.getNoDataProps,T=t.getResizerProps,z=t.showPagination,F=t.showPaginationTop,D=t.showPaginationBottom,R=t.manual,M=t.loadingText,j=t.noDataText,H=t.sortable,A=t.multiSort,$=t.resizable,B=t.filterable,_=t.pivotIDKey,I=t.pivotValKey,W=t.pivotBy,L=t.subRowsKey,G=t.aggregatedKey,K=t.originalKey,U=t.indexKey,J=t.groupedByPivotKey,q=t.loading,Q=t.pageSize,Z=t.page,ee=t.sorted,te=t.filtered,ne=t.resized,re=t.expanded,oe=t.pages,ae=t.onExpandedChange,ie=t.TableComponent,se=t.TheadComponent,le=t.TbodyComponent,ce=t.TrGroupComponent,ue=t.TrComponent,de=t.ThComponent,pe=t.TdComponent,me=t.TfootComponent,he=t.PaginationComponent,ge=t.LoadingComponent,fe=t.SubComponent,ve=t.NoDataComponent,be=t.ResizerComponent,ye=t.ExpanderComponent,Ee=t.PivotValueComponent,we=t.PivotComponent,Pe=t.AggregatedComponent,Ce=t.FilterComponent,xe=t.PadRowComponent,Se=t.resolvedData,ke=t.allVisibleColumns,Ne=t.headerGroups,Te=t.hasHeaderGroups,Oe=t.sortedData,ze=t.currentlyResizing,Fe=Q*Z,De=Fe+Q,Re=R?Se:Oe.slice(Fe,De),Me=this.getMinRows(),je=O.range(Math.max(Me-Re.length,0)),He=ke.some((function(e){return e.Footer})),Ae=B||ke.some((function(e){return e.filterable})),$e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return[t.map((function(t,o){var a=X({},t,{_viewIndex:r+=1}),i=n.concat([o]);if(a[L]&&O.get(re,i)){var s=e(a[L],i,r),l=Y(s,2);a[L]=l[0],r=l[1]}return a})),r]}(Re),Be=Y($e,1);Re=Be[0];var _e=Z>0,Ie=Z+1<oe,We=O.sum(ke.map((function(e){var t=ne.find((function(t){return t.id===e.id}))||{};return O.getFirstDefined(t.value,e.width,e.minWidth)}))),Le=-1,Ge=X({},t,{startRow:Fe,endRow:De,pageRows:Re,minRows:Me,padRows:je,hasColumnFooter:He,canPrevious:_e,canNext:Ie,rowMinWidth:We}),Ke=O.splitProps(a(Ge,void 0,void 0,this)),Ve=O.splitProps(i(Ge,void 0,void 0,this)),Ue=O.splitProps(f(Ge,void 0,void 0,this)),Je=S(Ge,void 0,void 0,this),qe=N(Ge,void 0,void 0,this),Ye=function(t,n){var r=function(e){return(ne.find((function(t){return t.id===e.id}))||{}).value},o=O.sum(t.columns.map((function(e){return e.width||r(e)?0:e.minWidth}))),a=O.sum(t.columns.map((function(e){return O.getFirstDefined(r(e),e.width,e.minWidth)}))),i=O.sum(t.columns.map((function(e){return O.getFirstDefined(r(e),e.width,e.maxWidth)}))),s=O.splitProps(c(Ge,void 0,t,e)),l=O.splitProps(t.getHeaderProps(Ge,void 0,t,e)),u=[t.headerClassName,s.className,l.className],d=X({},t.headerStyle,s.style,l.style),p=X({},s.rest,l.rest),m={flex:o+" 0 auto",width:O.asPx(a),maxWidth:O.asPx(i)};return w().createElement(de,X({key:n+"-"+t.id,className:k()(u),style:X({},d,m)},p),O.normalizeComponent(t.Header,{data:Oe,column:t}))},Xe=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o=ee.find((function(e){return e.id===t.id})),a="function"==typeof t.show?t.show():t.show,i=O.getFirstDefined(r.value,t.width,t.minWidth),s=O.getFirstDefined(r.value,t.width,t.maxWidth),l=O.splitProps(p(Ge,void 0,t,e)),c=O.splitProps(t.getHeaderProps(Ge,void 0,t,e)),u=[t.headerClassName,l.className,c.className],d=X({},t.headerStyle,l.style,c.style),m=X({},l.rest,c.rest),h=O.getFirstDefined(t.resizable,$,!1),g=h?w().createElement(be,X({onMouseDown:function(n){return e.resizeColumnStart(n,t,!1)},onTouchStart:function(n){return e.resizeColumnStart(n,t,!0)}},T("finalState",void 0,t,e))):null,f=O.getFirstDefined(t.sortable,H,!1);return w().createElement(de,X({key:n+"-"+t.id,className:k()(u,h&&"rt-resizable-header",o?o.desc?"-sort-desc":"-sort-asc":"",f&&"-cursor-pointer",!a&&"-hidden",W&&W.slice(0,-1).includes(t.id)&&"rt-header-pivot"),style:X({},d,{flex:i+" 0 auto",width:O.asPx(i),maxWidth:O.asPx(s)}),toggleSort:function(n){f&&e.sortColumn(t,!!A&&n.shiftKey)}},m),w().createElement("div",{className:k()(h&&"rt-resizable-header-content")},O.normalizeComponent(t.Header,{data:Oe,column:t})),g)},Qe=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o=O.getFirstDefined(r.value,t.width,t.minWidth),a=O.getFirstDefined(r.value,t.width,t.maxWidth),i=O.splitProps(g(Ge,void 0,t,e)),s=O.splitProps(t.getHeaderProps(Ge,void 0,t,e)),l=[t.headerClassName,i.className,s.className],c=X({},t.headerStyle,i.style,s.style),u=X({},i.rest,s.rest),d=te.find((function(e){return e.id===t.id})),p=t.Filter||Ce,m=O.getFirstDefined(t.filterable,B,!1);return w().createElement(de,X({key:n+"-"+t.id,className:k()(l),style:X({},c,{flex:o+" 0 auto",width:O.asPx(o),maxWidth:O.asPx(a)})},u),m?O.normalizeComponent(p,{column:t,filter:d,onChange:function(n){return e.filterColumn(t,n)}},V.column.Filter):null)},Ze=function t(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={original:n[K],row:n,index:n[U],viewIndex:Le+=1,pageSize:Q,page:Z,level:o.length,nestingPath:o.concat([r]),aggregated:n[G],groupedByPivot:n[J],subRows:n[L]},i=O.get(re,a.nestingPath),s=v(Ge,a,void 0,e),l=O.splitProps(b(Ge,a,void 0,e));return w().createElement(ce,X({key:a.nestingPath.join("_")},s),w().createElement(ue,X({className:k()(l.className,n._viewIndex%2?"-even":"-odd"),style:l.style},l.rest),ke.map((function(t,r){var o=ne.find((function(e){return e.id===t.id}))||{},s="function"==typeof t.show?t.show():t.show,l=O.getFirstDefined(o.value,t.width,t.minWidth),c=O.getFirstDefined(o.value,t.width,t.maxWidth),u=O.splitProps(y(Ge,a,t,e)),d=O.splitProps(t.getProps(Ge,a,t,e)),p=[u.className,t.className,d.className],m=X({},u.style,t.style,d.style),h=X({},a,{isExpanded:i,column:X({},t),value:a.row[t.id],pivoted:t.pivoted,expander:t.expander,resized:ne,show:s,width:l,maxWidth:c,tdProps:u,columnProps:d,classes:p,styles:m}),g=h.value,f=void 0,v=void 0,b=void 0,E=O.normalizeComponent(t.Cell,h,g),P=t.Aggregated||(t.aggregate?t.Cell:Pe),C=t.Expander||ye,x=t.PivotValue||Ee,S=we||function(e){return w().createElement("div",null,w().createElement(C,e),w().createElement(x,e))},N=t.Pivot||S;(h.pivoted||h.expander)&&(h.expandable=!0,f=!0,!h.pivoted||h.subRows||fe||(h.expandable=!1)),h.pivoted?(v=a.row[_]===t.id&&h.subRows,b=W.indexOf(t.id)>W.indexOf(a.row[_])&&h.subRows,E=v?O.normalizeComponent(N,X({},h,{value:n[I]}),n[I]):b?O.normalizeComponent(P,h,g):null):h.aggregated&&(E=O.normalizeComponent(P,h,g)),h.expander&&(E=O.normalizeComponent(C,h,n[I]),W&&(h.groupedByPivot&&(E=null),h.subRows||fe||(E=null)));var T=f?function(t){var n=O.clone(re);return n=i?O.set(n,h.nestingPath,!1):O.set(n,h.nestingPath,{}),e.setStateWithData({expanded:n},(function(){return ae&&ae(n,h.nestingPath,t,h)}))}:function(){},z={onClick:T};return u.rest.onClick&&(z.onClick=function(e){u.rest.onClick(e,(function(){return T(e)}))}),d.rest.onClick&&(z.onClick=function(e){d.rest.onClick(e,(function(){return T(e)}))}),w().createElement(pe,X({key:r+"-"+t.id,className:k()(p,!h.expandable&&!s&&"hidden",h.expandable&&"rt-expandable",(v||b)&&"rt-pivot"),style:X({},m,{flex:l+" 0 auto",width:O.asPx(l),maxWidth:O.asPx(c)})},u.rest,d.rest,z),E)}))),a.subRows&&i&&a.subRows.map((function(e,n){return t(e,n,a.nestingPath)})),fe&&!a.subRows&&i&&fe(a,(function(){var e=O.clone(re);O.set(e,a.nestingPath,!1)})))},et=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o="function"==typeof t.show?t.show():t.show,a=O.getFirstDefined(r.value,t.width,t.minWidth),i=a,s=O.getFirstDefined(r.value,t.width,t.maxWidth),l=O.splitProps(y(Ge,void 0,t,e)),c=O.splitProps(t.getProps(Ge,void 0,t,e)),u=[l.className,t.className,c.className],d=X({},l.style,t.style,c.style);return w().createElement(pe,X({key:n+"-"+t.id,className:k()(u,!o&&"hidden"),style:X({},d,{flex:i+" 0 auto",width:O.asPx(a),maxWidth:O.asPx(s)})},l.rest),O.normalizeComponent(xe))},tt=function(t,n){var r=v(Ge,void 0,void 0,e),o=O.splitProps(b(Ge,void 0,void 0,e));return w().createElement(ce,X({key:"pad-"+n},r),w().createElement(ue,{className:k()("-padRow",(Re.length+n)%2?"-even":"-odd",o.className),style:o.style||{}},ke.map(et)))},nt=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o="function"==typeof t.show?t.show():t.show,a=O.getFirstDefined(r.value,t.width,t.minWidth),i=O.getFirstDefined(r.value,t.width,t.maxWidth),s=O.splitProps(C(Ge,void 0,t,e)),l=O.splitProps(t.getProps(Ge,void 0,t,e)),c=O.splitProps(t.getFooterProps(Ge,void 0,t,e)),u=[s.className,t.className,l.className,c.className],d=X({},s.style,t.style,l.style,c.style);return w().createElement(pe,X({key:n+"-"+t.id,className:k()(u,!o&&"hidden"),style:X({},d,{flex:a+" 0 auto",width:O.asPx(a),maxWidth:O.asPx(i)})},l.rest,s.rest,c.rest),O.normalizeComponent(t.Footer,{data:Oe,column:t}))},rt=function(n){var r=O.splitProps(x(Ge,void 0,void 0,e));return w().createElement(he,X({},t,{pages:oe,canPrevious:_e,canNext:Ie,onPageChange:e.onPageChange,onPageSizeChange:e.onPageSizeChange,className:r.className,style:r.style,isTop:n},r.rest))},ot=function(){return w().createElement("div",X({className:k()("ReactTable",r,Ke.className),style:X({},o,Ke.style)},Ke.rest),z&&F?w().createElement("div",{className:"pagination-top"},rt(!0)):null,w().createElement(ie,X({className:k()(Ve.className,ze?"rt-resizing":""),style:Ve.style},Ve.rest),Te?(g=O.splitProps(s(Ge,void 0,void 0,e)),f=O.splitProps(l(Ge,void 0,void 0,e)),w().createElement(se,X({className:k()("-headerGroups",g.className),style:X({},g.style,{minWidth:We+"px"})},g.rest),w().createElement(ue,X({className:f.className,style:f.style},f.rest),Ne.map(Ye)))):null,(c=O.splitProps(u(Ge,void 0,void 0,e)),p=O.splitProps(d(Ge,void 0,void 0,e)),w().createElement(se,X({className:k()("-header",c.className),style:X({},c.style,{minWidth:We+"px"})},c.rest),w().createElement(ue,X({className:p.className,style:p.style},p.rest),ke.map(Xe)))),Ae?(a=O.splitProps(m(Ge,void 0,void 0,e)),i=O.splitProps(h(Ge,void 0,void 0,e)),w().createElement(se,X({className:k()("-filters",a.className),style:X({},a.style,{minWidth:We+"px"})},a.rest),w().createElement(ue,X({className:i.className,style:i.style},i.rest),ke.map(Qe)))):null,w().createElement(le,X({className:k()(Ue.className),style:X({},Ue.style,{minWidth:We+"px"})},Ue.rest),Re.map((function(e,t){return Ze(e,t)})),je.map(tt)),He?(t=O.splitProps(E(Ge,void 0,void 0,e)),n=O.splitProps(P(Ge,void 0,void 0,e)),w().createElement(me,X({className:t.className,style:X({},t.style,{minWidth:We+"px"})},t.rest),w().createElement(ue,X({className:k()(n.className),style:n.style},n.rest),ke.map(nt)))):null),z&&D?w().createElement("div",{className:"pagination-bottom"},rt(!1)):null,!Re.length&&w().createElement(ve,qe,O.normalizeComponent(j)),w().createElement(ge,X({loading:q,loadingText:M},Je)));var t,n,a,i,c,p,g,f};return n?n(Ge,ot,this):ot()}}]),t}(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),j(t,[{key:"getResolvedState",value:function(e,t){return M({},O.compactObject(this.state),O.compactObject(this.props),O.compactObject(t),O.compactObject(e))}},{key:"getDataModel",value:function(e,t){var n=this,r=e.columns,o=e.pivotBy,a=void 0===o?[]:o,i=e.data,s=e.resolveData,l=e.pivotIDKey,c=e.pivotValKey,u=e.subRowsKey,d=e.aggregatedKey,p=e.nestingLevelKey,m=e.originalKey,h=e.indexKey,g=e.groupedByPivotKey,f=e.SubComponent,v=!1;r.forEach((function(e){e.columns&&(v=!0)}));var b=[].concat(A(r)),y=r.find((function(e){return e.expander||e.columns&&e.columns.some((function(e){return e.expander}))}));y&&!y.expander&&(y=y.columns.find((function(e){return e.expander}))),f&&!y&&(b=[y={expander:!0}].concat(A(b)));var E=[],P=function(e,t){var r=function(e,t){var r=void 0;if((r=e.expander?M({},n.props.column,n.props.expanderDefaults,e):M({},n.props.column,e)).maxWidth<r.minWidth&&(r.minWidth=r.maxWidth),t&&(r.parentColumn=t),"string"==typeof r.accessor){r.id=r.id||r.accessor;var o=r.accessor;return r.accessor=function(e){return O.get(e,o)},r}if(r.accessor&&!r.id)throw console.warn(r),new Error("A column id is required if using a non-string accessor for column above.");return r.accessor||(r.accessor=function(){}),r}(e,t);return E.push(r),r},C=b.map((function(e){return e.columns?M({},e,{columns:e.columns.map((function(t){return P(t,e)}))}):P(e)})).slice(),x=[],S=(C=(C=C.map((function(e){if(e.columns){var t=e.columns.filter((function(e){return!(a.indexOf(e.id)>-1)&&O.getFirstDefined(e.show,!0)}));return M({},e,{columns:t})}return e}))).filter((function(e){return e.columns?e.columns.length:!(a.indexOf(e.id)>-1)&&O.getFirstDefined(e.show,!0)}))).findIndex((function(e){return e.pivot}));if(a.length){var k=[];a.forEach((function(e){var t=E.find((function(t){return t.id===e}));t&&k.push(t)}));var N=k.reduce((function(e,t){return e&&e===t.parentColumn&&t.parentColumn}),k[0].parentColumn),T=v&&N.Header,z={Header:T=T||function(){return w().createElement("strong",null,"Pivoted")},columns:k.map((function(e){return M({},n.props.pivotDefaults,e,{pivoted:!0})}))};S>=0?(z=M({},C[S],z),C.splice(S,1,z)):C.unshift(z)}var F=[],D=[],R=function(e,t){F.push(M({},n.props.column,t,{columns:e})),D=[]};C.forEach((function(e){if(e.columns)return x=x.concat(e.columns),D.length>0&&R(D),void R(e.columns,e);x.push(e),D.push(e)})),v&&D.length>0&&R(D);var j=function e(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=(H(r={},m,t),H(r,h,n),H(r,u,t[u]),H(r,p,o),r);return E.forEach((function(e){e.expander||(a[e.id]=e.accessor(t))})),a[u]&&(a[u]=a[u].map((function(t,n){return e(t,n,o+1)}))),a},$=this.resolvedData;this.resolvedData&&!t||($=s(i),this.resolvedData=$),$=$.map((function(e,t){return j(e,t)}));var B=x.filter((function(e){return!e.expander&&e.aggregate}));return a.length&&($=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r===n.length)return t;var o=Object.entries(O.groupBy(t,n[r])).map((function(e){var t,o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(e,2),a=o[0],i=o[1];return H(t={},l,n[r]),H(t,c,a),H(t,n[r],a),H(t,u,i),H(t,p,r),H(t,g,!0),t}));return o=o.map((function(t){var o,a=e(t[u],n,r+1);return M({},t,(H(o={},u,a),H(o,d,!0),o),function(e){var t={};return B.forEach((function(n){var r=e.map((function(e){return e[n.id]}));t[n.id]=n.aggregate(r,e)})),t}(a))})),o}($,a)),M({},e,{resolvedData:$,allVisibleColumns:x,headerGroups:F,allDecoratedColumns:E,hasHeaderGroups:v})}},{key:"getSortedData",value:function(e){var t=e.manual,n=e.sorted,r=e.filtered,o=e.defaultFilterMethod,a=e.resolvedData,i=e.allDecoratedColumns,s={};return i.filter((function(e){return e.sortMethod})).forEach((function(e){s[e.id]=e.sortMethod})),{sortedData:t?a:this.sortData(this.filterData(a,r,o,i),n,s)}}},{key:"fireFetchData",value:function(){var e=M({},this.getResolvedState(),{page:this.getStateOrProp("page"),pageSize:this.getStateOrProp("pageSize"),filtered:this.getStateOrProp("filtered")});this.props.onFetchData(e,this)}},{key:"getPropOrState",value:function(e){return O.getFirstDefined(this.props[e],this.state[e])}},{key:"getStateOrProp",value:function(e){return O.getFirstDefined(this.state[e],this.props[e])}},{key:"filterData",value:function(e,t,n,r){var o=this,a=e;return t.length&&(a=(a=t.reduce((function(e,t){var o=r.find((function(e){return e.id===t.id}));if(!o||!1===o.filterable)return e;var a=o.filterMethod||n;return o.filterAll?a(t,e,o):e.filter((function(e){return a(t,e,o)}))}),a)).map((function(e){return e[o.props.subRowsKey]?M({},e,H({},o.props.subRowsKey,o.filterData(e[o.props.subRowsKey],t,n,r))):e})).filter((function(e){return!e[o.props.subRowsKey]||e[o.props.subRowsKey].length>0}))),a}},{key:"sortData",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.length)return e;var o=(this.props.orderByMethod||O.orderBy)(e,t.map((function(e){return r[e.id]?function(t,n){return r[e.id](t[e.id],n[e.id],e.desc)}:function(t,r){return n.props.defaultSortMethod(t[e.id],r[e.id],e.desc)}})),t.map((function(e){return!e.desc})),this.props.indexKey);return o.forEach((function(e){e[n.props.subRowsKey]&&(e[n.props.subRowsKey]=n.sortData(e[n.props.subRowsKey],t,r))})),o}},{key:"getMinRows",value:function(){return O.getFirstDefined(this.props.minRows,this.getStateOrProp("pageSize"))}},{key:"onPageChange",value:function(e){var t=this.props,n=t.onPageChange,r=t.collapseOnPageChange,o={page:e};r&&(o.expanded={}),this.setStateWithData(o,(function(){return n&&n(e)}))}},{key:"onPageSizeChange",value:function(e){var t=this.props.onPageSizeChange,n=this.getResolvedState(),r=n.pageSize*n.page,o=Math.floor(r/e);this.setStateWithData({pageSize:e,page:o},(function(){return t&&t(e,o)}))}},{key:"sortColumn",value:function(e,t){var n=this.getResolvedState(),r=n.sorted,o=n.skipNextSort,a=n.defaultSortDesc,i=Object.prototype.hasOwnProperty.call(e,"defaultSortDesc")?e.defaultSortDesc:a,s=!i;if(o)this.setStateWithData({skipNextSort:!1});else{var l=this.props.onSortedChange,c=O.clone(r||[]).map((function(e){return e.desc=O.isSortingDesc(e),e}));if(O.isArray(e)){var u=c.findIndex((function(t){return t.id===e[0].id}));u>-1?(c[u].desc===s?t?c.splice(u,e.length):e.forEach((function(e,t){c[u+t].desc=i})):e.forEach((function(e,t){c[u+t].desc=s})),t||(c=c.slice(u,e.length))):c=t?c.concat(e.map((function(e){return{id:e.id,desc:i}}))):e.map((function(e){return{id:e.id,desc:i}}))}else{var d=c.findIndex((function(t){return t.id===e.id}));if(d>-1){var p=c[d];p.desc===s?t?c.splice(d,1):(p.desc=i,c=[p]):(p.desc=s,t||(c=[p]))}else t?c.push({id:e.id,desc:i}):c=[{id:e.id,desc:i}]}this.setStateWithData({page:!r.length&&c.length||!t?0:this.state.page,sorted:c},(function(){return l&&l(c,e,t)}))}}},{key:"filterColumn",value:function(e,t){var n=this.getResolvedState().filtered,r=this.props.onFilteredChange,o=(n||[]).filter((function(t){return t.id!==e.id}));""!==t&&o.push({id:e.id,value:t}),this.setStateWithData({filtered:o},(function(){return r&&r(o,e,t)}))}},{key:"resizeColumnStart",value:function(e,t,n){var r=this;e.stopPropagation();var o,a=e.target.parentElement.getBoundingClientRect().width;o=n?e.changedTouches[0].pageX:e.pageX,this.trapEvents=!0,this.setStateWithData({currentlyResizing:{id:t.id,startX:o,parentWidth:a}},(function(){n?(document.addEventListener("touchmove",r.resizeColumnMoving),document.addEventListener("touchcancel",r.resizeColumnEnd),document.addEventListener("touchend",r.resizeColumnEnd)):(document.addEventListener("mousemove",r.resizeColumnMoving),document.addEventListener("mouseup",r.resizeColumnEnd),document.addEventListener("mouseleave",r.resizeColumnEnd))}))}},{key:"resizeColumnMoving",value:function(e){e.stopPropagation();var t=this.props,n=t.onResizedChange,r=t.column,o=this.getResolvedState(),a=o.resized,i=o.currentlyResizing,s=o.columns.find((function(e){return e.accessor===i.id||e.id===i.id})),l=s&&null!=s.minResizeWidth?s.minResizeWidth:r.minResizeWidth,c=a.filter((function(e){return e.id!==i.id})),u=void 0;"touchmove"===e.type?u=e.changedTouches[0].pageX:"mousemove"===e.type&&(u=e.pageX);var d=Math.max(i.parentWidth+u-i.startX,l);c.push({id:i.id,value:d}),this.setStateWithData({resized:c},(function(){return n&&n(c,e)}))}},{key:"resizeColumnEnd",value:function(e){e.stopPropagation();var t="touchend"===e.type||"touchcancel"===e.type;t&&(document.removeEventListener("touchmove",this.resizeColumnMoving),document.removeEventListener("touchcancel",this.resizeColumnEnd),document.removeEventListener("touchend",this.resizeColumnEnd)),document.removeEventListener("mousemove",this.resizeColumnMoving),document.removeEventListener("mouseup",this.resizeColumnEnd),document.removeEventListener("mouseleave",this.resizeColumnEnd),t||this.setStateWithData({skipNextSort:!0,currentlyResizing:!1})}}]),t}(function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),R(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setStateWithData(this.getDataModel(this.getResolvedState(),!0))}},{key:"componentDidMount",value:function(){this.fireFetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e,t){var n=this.getResolvedState(),r=this.getResolvedState(e,t);["sorted","filtered","resized","expanded"].forEach((function(e){var t="default"+(e.charAt(0).toUpperCase()+e.slice(1));JSON.stringify(n[t])!==JSON.stringify(r[t])&&(r[e]=r[t])})),["sortable","filterable","resizable"].forEach((function(e){if(n[e]!==r[e]){var t=e.replace("able","")+"ed",o="default"+(t.charAt(0).toUpperCase()+t.slice(1));r[t]=r[o]}})),n.data===r.data&&n.columns===r.columns&&n.pivotBy===r.pivotBy&&n.sorted===r.sorted&&n.filtered===r.filtered||this.setStateWithData(this.getDataModel(r,n.data!==r.data))}},{key:"setStateWithData",value:function(e,t){var n=this,r=this.getResolvedState(),o=this.getResolvedState({},e),a=o.freezeWhenExpanded;if(o.frozen=!1,a)for(var i=Object.keys(o.expanded),s=0;s<i.length;s+=1)if(o.expanded[i[s]]){o.frozen=!0;break}return(r.frozen&&!o.frozen||r.sorted!==o.sorted||r.filtered!==o.filtered||r.showFilters!==o.showFilters||!o.frozen&&r.resolvedData!==o.resolvedData)&&((r.sorted!==o.sorted&&this.props.collapseOnSortingChange||r.filtered!==o.filtered||r.showFilters!==o.showFilters||r.sortedData&&!o.frozen&&r.resolvedData!==o.resolvedData&&this.props.collapseOnDataChange)&&(o.expanded={}),Object.assign(o,this.getSortedData(o))),r.filtered!==o.filtered&&(o.page=0),o.sortedData&&(o.pages=o.manual?o.pages:Math.ceil(o.sortedData.length/o.pageSize),o.page=o.manual?o.page:Math.max(o.page>=o.pages?o.pages-1:o.page,0)),this.setState(o,(function(){t&&t(),r.page===o.page&&r.pageSize===o.pageSize&&r.sorted===o.sorted&&r.filtered===o.filtered||n.fireFetchData()}))}}]),t}(E.Component)));Z.propTypes=q,Z.defaultProps=V;const ee=Z;var te=d(7388);const ne=["#E24D42","#1F78C1","#BA43A9","#705DA0","#466803","#508642","#447EBC","#C15C17","#890F02","#757575","#0A437C","#6D1F62","#584477","#629E51","#2F4F4F","#BF1B00","#806EB7","#8a2eb8","#699e00","#000000","#3F6833","#2F575E","#99440A","#E0752D","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],re=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"],oe=/^https?:\/\/.+/,ae=({tag:e,datasource:t,highlight:n,onClick:r})=>{const o=(0,te.useStyles2)(ie),a=function(e){const t=function(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t}(e.toLowerCase());return{color:ne[Math.abs(t%ne.length)],borderColor:re[Math.abs(t%re.length)]}}(e.tag),i={background:a.color,borderColor:a.borderColor},s=oe.test(e.value);let l=w().createElement(w().Fragment,null,e.value?`${e.tag}: ${e.value}`:`${e.tag}`);return s&&(l=w().createElement(te.Tooltip,{placement:"top",content:e.value},w().createElement("a",{href:e.value,target:"_blank",rel:"noreferrer"},w().createElement(te.Icon,{name:"link",className:o.icon}),e.tag))),w().createElement("span",{className:"label label-tag zbx-tag "+(n?"highlighted":""),style:i,onClick:n=>{r&&r(e,t,n.ctrlKey,n.shiftKey)}},l)},ie=e=>({icon:x.css`
    margin-right: ${e.spacing(.5)};
  `}),se=({status:e,className:t})=>{const n=(0,x.cx)(t,"icon-gf",{"icon-gf-critical":"critical"===e||"problem"===e||"warning"===e},{"icon-gf-online":"online"===e||"ok"===e});return w().createElement("i",{className:n})},le=({icon:e,customClass:t})=>{const n=(0,x.cx)(t,"fa-icon-container");return w().createElement("span",{className:n},w().createElement("i",{className:`fa fa-${e}`}))},ce=le,ue=({icon:e,width:t,tooltip:n,className:r,children:o,onClick:a})=>{const i=(0,te.useTheme)(),s=de(i),l=(0,x.cx)("btn",s.button,x.css`
      width: ${t||3}rem;
    `,r);let c=w().createElement("button",{className:l,onClick:a},e&&w().createElement(le,{icon:e,customClass:s.icon}),o);return n&&(c=w().createElement(te.Tooltip,{placement:"bottom",content:n},c)),c},de=(0,te.stylesFactory)((e=>{const t=e.type===c.GrafanaThemeType.Light?"#497dc0":"#005f81",n=e.type===c.GrafanaThemeType.Light?"#456ba4":"#354f77";return{button:x.css`
      height: 2rem;
      background-image: none;
      background-color: ${t};
      border: 1px solid ${e.palette.gray1};
      border-radius: 1px;
      color: ${e.colors.text};

      i {
        vertical-align: middle;
      }

      &:hover {
        background-color: ${n};
      }
    `,icon:x.css`
      i {
        color: ${e.colors.text};
      }
    `}})),pe=({className:e,onClick:t})=>w().createElement(ue,{className:e,icon:"reply-all",tooltip:"Acknowledge problem",onClick:t}),me=({problem:e,panelId:t,range:n})=>w().createElement(ue,{icon:"compass",width:6,onClick:()=>he(e,t,n)},"Explore"),he=(e,t,n)=>{var r,o;let a={};if(1===(null===(r=e.items)||void 0===r?void 0:r.length)&&1===(null===(o=e.hosts)||void 0===o?void 0:o.length)){const t=e.items[0],n=e.hosts[0],r=v(t.name,t.key_);a={queryType:"0",group:{filter:"/.*/"},application:{filter:""},host:{filter:n.name},item:{filter:r}}}else{var i;a={queryType:"3",itemids:null===(i=e.items)||void 0===i?void 0:i.map((e=>e.itemid)).join(",")}}const s={datasource:e.datasource,context:"explore",originPanelId:t,range:n.raw,queries:[a]},l=JSON.stringify(s),u=c.urlUtil.renderUrl("/explore",{left:l});P.locationService.push(u)},ge=({className:e,onClick:t})=>w().createElement(ue,{className:e,icon:"terminal",tooltip:"Execute script",onClick:t});var fe=d(2729),ve=d.n(fe);function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){be(e,t,n[t])}))}return e}const Ee=w().createContext(P.config),we=Ee.Consumer,Pe=({children:e})=>w().createElement(we,null,(t=>w().createElement(te.ThemeContext.Provider,{value:(0,c.createTheme)({colors:{mode:P.config.bootData.user.lightTheme?"light":"dark"}})},e)));function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xe extends w().Component{renderModal(){const{component:e,props:t}=this.state;if(!e)return null;this.modalRoot.appendChild(this.modalNode);const n=w().createElement((e=>(e=>t=>w().createElement(Ee.Provider,{value:P.config},w().createElement(e,ye({},t))))((t=>w().createElement(Pe,null,w().createElement(e,ye({},t))))))(e),t);return ve().createPortal(n,this.modalNode)}render(){const{children:e}=this.props,t=e;return w().createElement(w().Fragment,null,w().createElement(t,{showModal:this.showModal,hideModal:this.hideModal}),this.renderModal())}constructor(e){super(e),Ce(this,"modalRoot",document.body),Ce(this,"modalNode",document.createElement("div")),Ce(this,"showModal",((e,t)=>{this.setState({component:e,props:t})})),Ce(this,"hideModal",(()=>{this.modalRoot.removeChild(this.modalNode),this.setState({component:null,props:{}})})),this.state={component:null,props:{}}}}w().forwardRef((({data:e,isFocused:t,disabled:n,onClick:r,hideDescription:o},a)=>{const i=(0,te.useTheme2)(),s=(0,te.getSelectStyles)(i),l=(0,te.useStyles2)(Se()),c=(0,x.cx)(s.option,l.menuOptionWrapper,t&&s.optionFocused,n&&l.menuOptionDisabled);return w().createElement("div",{ref:a,className:c,"aria-label":"Menu option",onClick:t=>{n||(t.preventDefault(),t.stopPropagation(),r(e))}},w().createElement("div",{className:(0,x.cx)(s.optionBody,l.menuOptionBody)},w().createElement("span",null,e.label||e.value),!o&&e.description&&w().createElement("div",{className:s.optionDescription},e.description)),e.description&&w().createElement(te.Tooltip,{content:e.description},w().createElement(te.Icon,{name:"info-circle",className:l.menuOptionInfoSign})))})).displayName="MenuOption";const Se=e=>t=>({menuWrapper:x.css`
      display: flex;
      max-height: 650px;
      position: absolute;
      z-index: ${t.zIndex.dropdown};
      overflow: hidden;
      min-width: auto;
    `,menu:x.css`
      min-width: ${t.spacing(e||0)};

      & > div {
        padding-top: ${t.spacing(1)};
      }
    `,menuLeft:x.css`
      right: 0;
      flex-direction: row-reverse;
    `,container:x.css`
      padding: ${t.spacing(1)};
      border: 1px ${t.colors.border.weak} solid;
      border-radius: ${t.shape.borderRadius(1)};
      background-color: ${t.colors.background.primary};
      z-index: ${t.zIndex.modal};
    `,menuOptionWrapper:x.css`
      padding: ${t.spacing(.5)};
    `,menuOptionBody:x.css`
      font-weight: ${t.typography.fontWeightRegular};
      padding: ${t.spacing(0,1.5,0,0)};
    `,menuOptionDisabled:x.css`
      color: ${t.colors.text.disabled};
      cursor: not-allowed;
    `,menuOptionInfoSign:x.css`
      color: ${t.colors.text.disabled};
    `});function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ne=[{value:0,label:"Not classified"},{value:1,label:"Information"},{value:2,label:"Warning"},{value:3,label:"Average"},{value:4,label:"High"},{value:5,label:"Disaster"}];class Te extends E.PureComponent{renderActions(){const{canClose:e}=this.props;return[w().createElement(te.Checkbox,{key:"ack",label:"Acknowledge",value:this.state.acknowledge,onChange:this.onAcknowledgeToggle}),w().createElement(te.Checkbox,{key:"change-severity",label:"Change severity",description:"",value:this.state.changeSeverity,onChange:this.onChangeSeverityToggle}),this.state.changeSeverity&&w().createElement(te.RadioButtonGroup,{key:"severity",size:"sm",options:Ne,value:this.state.selectedSeverity,onChange:this.onChangeSelectedSeverity}),e&&w().createElement(te.Checkbox,{key:"close",label:"Close problem",disabled:!e,value:this.state.closeProblem,onChange:this.onCloseProblemToggle})].filter((e=>e))}render(){const{theme:e}=this.props,t=Oe(e);return w().createElement(te.Modal,{isOpen:!0,onDismiss:this.dismiss,className:t.modal,title:w().createElement("div",{className:t.modalHeaderTitle},this.state.loading?w().createElement(te.Spinner,{size:18}):w().createElement(le,{icon:"reply-all"}),"Acknowledge Problem")},w().createElement("div",{className:t.inputGroup},w().createElement(te.TextArea,{className:this.state.error&&t.input,type:"text",name:"message",placeholder:"Message",autoComplete:"off",autoFocus:!0,value:this.state.value,onChange:this.handleChange,onKeyDown:this.handleKeyPress}),w().createElement("small",{className:t.inputHint},"Press Enter to submit"),this.state.error&&w().createElement("small",{className:t.inputError},this.state.errorMessage)),w().createElement(te.VerticalGroup,null,this.renderActions()),this.state.ackError&&w().createElement("span",{className:t.ackError},this.state.ackError),w().createElement(te.ButtonGroup,{className:t.buttonGroup},w().createElement(te.Button,{variant:"primary",onClick:this.submit},"Update"),w().createElement(te.Button,{variant:"secondary",onClick:this.dismiss},"Cancel")))}constructor(e){super(e),ke(this,"handleChange",(e=>{this.setState({value:e.target.value,error:!1})})),ke(this,"handleKeyPress",(e=>{13===e.which||"Enter"===e.key||27!==e.which&&"Escape"!==e.key||this.dismiss()})),ke(this,"handleBackdropClick",(()=>{this.dismiss()})),ke(this,"onAcknowledgeToggle",(()=>{this.setState({acknowledge:!this.state.acknowledge,error:!1})})),ke(this,"onChangeSeverityToggle",(()=>{this.setState({changeSeverity:!this.state.changeSeverity,error:!1})})),ke(this,"onCloseProblemToggle",(()=>{this.setState({closeProblem:!this.state.closeProblem,error:!1})})),ke(this,"onChangeSelectedSeverity",(e=>{this.setState({selectedSeverity:e})})),ke(this,"dismiss",(()=>{this.setState({value:"",error:!1,errorMessage:"",ackError:"",loading:!1}),this.props.onDismiss()})),ke(this,"submit",(()=>{const{acknowledge:e,changeSeverity:t,closeProblem:n}=this.state,r=e||t||n;if(!this.state.value&&!r)return this.setState({error:!0,errorMessage:"Enter message text or select an action"});this.setState({ackError:"",loading:!0});const o={message:this.state.value};let a=4;this.state.acknowledge&&(a+=2),this.state.changeSeverity&&(a+=8,o.severity=this.state.selectedSeverity),this.state.closeProblem&&(a+=1),o.action=a,this.props.onSubmit(o).then((()=>{this.dismiss()})).catch((e=>{var t,n;const r=(null===(t=e.data)||void 0===t?void 0:t.message)||(null===(n=e.data)||void 0===n?void 0:n.error)||e.data||e.statusText||"";this.setState({ackError:r,loading:!1})}))})),this.state={value:"",error:!1,errorMessage:"",ackError:"",acknowledge:!1,closeProblem:!1,changeSeverity:!1,selectedSeverity:e.severity||0,loading:!1}}}ke(Te,"defaultProps",{withBackdrop:!0});const Oe=(0,te.stylesFactory)((e=>{const t=e.palette.red;return{modal:x.css`
      width: 500px;
    `,modalHeaderTitle:x.css`
      font-size: ${e.typography.heading.h3};
      padding-top: ${e.spacing.sm};
      margin: 0 ${e.spacing.md};
      display: flex;
    `,inputGroup:x.css`
      margin-bottom: 16px;
    `,input:x.css`
      border-color: ${t};
      border-radius: 2px;
      outline-offset: 2px;
      box-shadow:
        0 0 0 2px ${e.colors.bg1},
        0 0 0px 4px ${t};
    `,inputHint:x.css`
      display: inherit;
      float: right;
      color: ${e.colors.textWeak};
    `,inputError:x.css`
      float: left;
      color: ${t};
    `,ackError:x.css`
      color: ${t};
    `,buttonGroup:x.css`
      justify-content: center;
      gap: ${e.spacing.sm};
      margin-top: ${e.spacing.md};
    `}})),ze=(0,te.withTheme)(Te);function Fe(e){const{acknowledges:t}=e;return w().createElement("div",{className:"problem-ack-list"},w().createElement("div",{className:"problem-ack-col problem-ack-time"},t.map((e=>w().createElement("span",{key:e.acknowledgeid,className:"problem-ack-time"},e.time)))),w().createElement("div",{className:"problem-ack-col problem-ack-user"},t.map((e=>w().createElement("span",{key:e.acknowledgeid,className:"problem-ack-user"},function(e){return e.name||e.surname?`${e.name} ${e.surname}`.trim():e.user}(e))))),w().createElement("div",{className:"problem-ack-col problem-ack-message"},t.map((e=>w().createElement("span",{key:e.acknowledgeid,className:"problem-ack-message"},e.message)))))}function De(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){De(e,t,n[t])}))}return e}const Me=Math.round(9.6);class je extends E.PureComponent{componentDidUpdate(e,t){if(this.rootRef&&t.width!==this.rootRef.clientWidth){const e=this.rootRef.clientWidth;this.setState({width:e})}}getEventDuration(e,t){return 1e3*Math.abs(Number(this.sortedEvents[e].clock)-Number(this.sortedEvents[t].clock))}sortEvents(){const e=m().sortBy(this.props.events,(e=>Number(e.clock)));return this.sortedEvents=e,e}getEventAcks(e){const t=[];for(const n of e)if(n.acknowledges)for(const e of n.acknowledges)t.push(e);return m().sortBy(t,(e=>Number(e.clock)))}render(){if(!this.rootRef)return w().createElement("div",{className:"event-timeline",ref:this.setRootRef});const{timeRange:e,eventPointSize:t,eventRegionHeight:n}=this.props,r=this.sortEvents(),o=this.getEventAcks(r),a=this.state.width+t,i=Math.round(2.5*t),s=a-t,l=Math.round(t/2),c=n/2,u=Math.round(i/2-t/2);return w().createElement("div",{className:"event-timeline",ref:this.setRootRef,style:{transform:`translate(${-l}px, 0)`}},w().createElement(Ae,{className:"timeline-info-container",event:this.state.highlightedEvent,eventInfo:this.state.eventInfo,show:this.state.showEventInfo,left:l}),w().createElement("svg",{className:"event-timeline-canvas",viewBox:`0 0 ${a} ${i}`},w().createElement("defs",null,w().createElement(He,null)),w().createElement("g",{className:"event-timeline-group",transform:`translate(${l}, ${u})`},w().createElement("g",{className:"event-timeline-regions",filter:"url(#boxShadow)"},w().createElement($e,{events:r,timeRange:e,width:s,height:n,highlightedRegion:this.state.highlightedRegion})),w().createElement("g",{className:"timeline-acknowledges",transform:`translate(0, ${c})`},w().createElement(Ie,{acknowledges:o,timeRange:e,width:s,size:t,onHighlight:this.handleAckHighlight,onUnHighlight:this.handleAckUnHighlight})),w().createElement("g",{className:"timeline-points",transform:`translate(0, ${c})`},w().createElement(Be,{events:r,timeRange:e,width:s,pointSize:t,onPointHighlight:this.handlePointHighlight,onPointUnHighlight:this.handlePointUnHighlight})))))}constructor(e){super(e),De(this,"rootRef",void 0),De(this,"sortedEvents",void 0),De(this,"setRootRef",(e=>{this.rootRef=e;const t=e&&e.clientWidth||0;this.setState({width:t})})),De(this,"handlePointHighlight",((e,t)=>{const n=this.sortedEvents[e],r=this.getRegionToHighlight(e);let o;void 0!==t&&(o=this.getEventDuration(e,t)),this.setState({highlightedEvent:n,showEventInfo:!0,highlightedRegion:r,eventInfo:{duration:o}})})),De(this,"handlePointUnHighlight",(()=>{this.setState({showEventInfo:!1,highlightedRegion:null})})),De(this,"handleAckHighlight",((e,t)=>{this.setState({showEventInfo:!0,eventInfo:{timestamp:Number(e.clock),message:e.message}})})),De(this,"handleAckUnHighlight",(()=>{this.setState({showEventInfo:!1})})),De(this,"showEventInfo",(e=>{this.setState({highlightedEvent:e,showEventInfo:!0})})),De(this,"hideEventInfo",(()=>{this.setState({showEventInfo:!1})})),De(this,"getRegionToHighlight",(e=>"1"===this.sortedEvents[e].value?e+1:e)),this.state={width:0,highlightedEvent:null,highlightedRegion:null,showEventInfo:!1,eventInfo:{}}}}function He(){return w().createElement(w().Fragment,null,w().createElement("filter",{id:"dropShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},w().createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"2"}),w().createElement("feOffset",{dx:"1",dy:"1"}),w().createElement("feMerge",null,w().createElement("feMergeNode",null),w().createElement("feMergeNode",{in:"SourceGraphic"}))),w().createElement("filter",{id:"boxShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},w().createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"1"}),w().createElement("feComponentTransfer",null,w().createElement("feFuncA",{type:"linear",slope:"0.7"})),w().createElement("feOffset",{dx:"1",dy:"1"}),w().createElement("feMerge",null,w().createElement("feMergeNode",null),w().createElement("feMergeNode",{in:"SourceGraphic"}))),w().createElement("filter",{id:"glowShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},w().createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2"}),w().createElement("feMerge",null,w().createElement("feMergeNode",null),w().createElement("feMergeNode",{in:"SourceGraphic"}))),w().createElement("filter",{id:"timelinePointBlur",x:"-50%",y:"-50%",width:"200%",height:"200%"},w().createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blurOut"})))}De(je,"defaultProps",{okColor:"rgb(56, 189, 113)",problemColor:"rgb(215, 0, 0)",eventRegionHeight:Me,eventPointSize:16});class Ae extends E.PureComponent{render(){const{event:e,eventInfo:t,show:n,className:r,left:o}=this.props;let a,i;if(e){const t=g()(1e3*Number(e.clock)).format("HH:mm:ss");a=[w().createElement("span",{key:"ts",className:"event-timestamp"},w().createElement("span",{className:"event-timestamp-label"},"Time: "),w().createElement("span",{className:"event-timestamp-value"},t))]}if(t&&t.duration){const e=t.duration,n=g().utc(e).format("HH:mm:ss");i=w().createElement("span",{key:"duration",className:"event-timestamp"},w().createElement("span",{className:"event-timestamp-label"},"Duration: "),w().createElement("span",{className:"event-timestamp-value"},n))}if(t&&t.timestamp){const e=g()(1e3*t.timestamp).format("HH:mm:ss");a=[w().createElement("span",{key:"ts",className:"event-timestamp"},w().createElement("span",{className:"event-timestamp-label"},"Time: "),w().createElement("span",{className:"event-timestamp-value"},e))]}const s={left:o};return n||(s.opacity=0),w().createElement("div",{className:r,style:s},w().createElement("div",null,a),w().createElement("div",null,i),t&&t.message&&w().createElement("div",null,w().createElement("span",{key:"duration",className:"event-timestamp"},w().createElement("span",{className:"event-timestamp-label"},"Message: "),w().createElement("span",{className:"event-timestamp-value"},t.message))))}}De(Ae,"defaultProps",{left:0,className:"",show:!1});class $e extends E.PureComponent{render(){const{events:e,timeRange:t,width:n,height:r,highlightedRegion:o}=this.props,a=t.from.unix(),i=t.to.unix(),s=i-a;let l;if(e.length){const t=((e.length?Number(e[0].clock):i)-a)/s,c=Math.round(t*n),u=0===o,d=`problem-event-region ${"problem-event--"+("1"!==e[0].value?"problem":"ok")} ${u?"highlighted":""}`,p={x:0,y:0,width:c,height:r};l=w().createElement("rect",Re({key:"0",className:d},p))}const c=e.map(((t,l)=>{const c=Number(t.clock),u=((l<e.length-1?Number(e[l+1].clock):i)-c)/s,d=Math.round(u*n),p=Math.round((c-a)/s*n),m=o&&o-1===l,h=`problem-event-region ${"problem-event--"+("1"===t.value?"problem":"ok")} ${m?"highlighted":""}`,g={x:p,y:0,width:d,height:r};return w().createElement("rect",Re({key:`${t.eventid}-${l}`,className:h},g))}));return w().createElement(w().Fragment,null,l,c)}}De($e,"defaultProps",{highlightedRegion:null});class Be extends E.PureComponent{getRegionEvents(e){const t=this.props.events,n=t[e];if("1"===n.value&&e<t.length){for(let n=e;n<t.length;n++)if("0"===t[n].value)return[e,n]}else if("0"===n.value&&e>0){let n=null;for(let r=e-1;r>=0&&"1"===t[r].value;r--)n=r;if(null!==n)return[e,n]}return[e]}render(){const{events:e,timeRange:t,width:n,pointSize:r}=this.props,o=t.from.unix(),a=t.to.unix()-o,i=r/2,s=e.map(((e,t)=>{const r=Number(e.clock),s=Math.round((r-o)/a*n-i),l="problem-event-item problem-event--"+("1"===e.value?"problem":"ok"),c=-1!==this.state.highlighted.indexOf(t);return w().createElement(_e,{key:`${e.eventid}-${t}`,className:l,x:s,r:i,highlighted:c,onPointHighlight:this.highlightPoint(t),onPointUnHighlight:this.unHighlightPoint(t)})}));return this.state.order.length?this.state.order.map((e=>s[e])):s}constructor(e){super(e),De(this,"bringToFront",((e,t=!1)=>{const{events:n}=this.props;let r=n.map(((e,t)=>t));r=Le(r,e);const o=t?e:null;this.setState({order:r,highlighted:o})})),De(this,"highlightPoint",(e=>()=>{let t=[e];if(this.props.onPointHighlight)if(this.props.highlightRegion){t=this.getRegionEvents(e);const n=2===t.length?t[1]:void 0;this.props.onPointHighlight(e,n)}else this.props.onPointHighlight(e);this.bringToFront(t,!0)})),De(this,"unHighlightPoint",(e=>()=>{this.props.onPointUnHighlight&&this.props.onPointUnHighlight();const e=this.props.events.map(((e,t)=>t));this.setState({order:e,highlighted:[]})})),this.state={order:[],highlighted:[]}}}De(Be,"defaultProps",{highlightRegion:!0});class _e extends E.PureComponent{componentDidUpdate(e){e.highlighted!==this.props.highlighted&&this.setState({highlighted:this.props.highlighted})}render(){const{x:e}=this.props,t=this.state.highlighted?Math.round(1.1*this.props.r):this.props.r,n=e+this.props.r,r=Math.round(.6*t),o=`${this.props.className||""} ${this.state.highlighted?"highlighted":""}`;return w().createElement("g",{className:o,transform:`translate(${n}, 0)`,filter:"url(#dropShadow)",onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave},w().createElement("circle",{cx:0,cy:0,r:t,className:"point-border"}),w().createElement("circle",{cx:0,cy:0,r,className:"point-core"}))}constructor(e){super(e),De(this,"handleMouseOver",(()=>{this.props.onPointHighlight&&this.props.onPointHighlight()})),De(this,"handleMouseLeave",(()=>{this.props.onPointUnHighlight&&this.props.onPointUnHighlight()})),this.state={highlighted:!1}}}class Ie extends E.PureComponent{render(){const{acknowledges:e,timeRange:t,width:n,size:r}=this.props,o=t.from.unix(),a=t.to.unix()-o,i=r/2,s=e.map(((e,t)=>{const r=Number(e.clock),s=Math.round((r-o)/a*n-i),l=this.state.highlighted===t;return w().createElement(We,{key:`${e.eventid}-${t}`,x:s,r:i,highlighted:l,onHighlight:this.handleHighlight(t),onUnHighlight:this.handleUnHighlight})}));return this.state.order.length?this.state.order.map((e=>s[e])):s}constructor(e){super(e),De(this,"handleHighlight",(e=>()=>{if(this.props.onHighlight){const t=this.props.acknowledges[e];this.props.onHighlight(t,e)}this.bringToFront(e,!0)})),De(this,"handleUnHighlight",(()=>{this.props.onUnHighlight&&this.props.onUnHighlight();const e=this.props.acknowledges.map(((e,t)=>t));this.setState({order:e,highlighted:null})})),De(this,"bringToFront",((e,t=!1)=>{const{acknowledges:n}=this.props;let r=n.map(((e,t)=>t));r=Le(r,[e]);const o=t?e:null;this.setState({order:r,highlighted:o})})),this.state={order:[],highlighted:null}}}class We extends E.PureComponent{componentDidUpdate(e){e.highlighted!==this.props.highlighted&&this.setState({highlighted:this.props.highlighted})}render(){const{x:e}=this.props,t=this.state.highlighted?Math.round(1.1*this.props.r):this.props.r,n=e+this.props.r,r=Math.round(.6*t),o="problem-event-ack "+(this.state.highlighted?"highlighted":"");return w().createElement("g",{className:o,transform:`translate(${n}, 0)`,filter:"url(#dropShadow)",onMouseOver:this.handleHighlight,onMouseLeave:this.handleUnHighlight},w().createElement("circle",{cx:0,cy:0,r:t,className:"point-border"}),w().createElement("circle",{cx:0,cy:0,r,className:"point-core"}))}constructor(e){super(e),De(this,"handleHighlight",(()=>{this.props.onHighlight&&this.props.onHighlight()})),De(this,"handleUnHighlight",(()=>{this.props.onUnHighlight&&this.props.onUnHighlight()})),this.state={highlighted:!1}}}function Le(e,t){const n=m().pullAt(e,t);return n.reverse(),e.push(...n),e}function Ge(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ve extends E.PureComponent{componentDidMount(){var e,t=this;return(e=function*(){var e;const n=yield t.props.getScripts();t.scripts=n;const r=n.map((e=>({value:e.scriptid,label:e.name,description:e.description||e.command}))),o=(null===(e=r)||void 0===e?void 0:e.length)?r[0]:null,a=n.find((e=>o.value===e.scriptid));t.setState({scriptOptions:r,selectedScript:o,script:a})},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ge(a,r,o,i,s,"next",e)}function s(e){Ge(a,r,o,i,s,"throw",e)}i(void 0)}))})()}render(){const{theme:e}=this.props,{scriptOptions:t,selectedScript:n,script:r,result:o,selectError:a,errorMessage:i,error:s}=this.state,l=Ue(e);return w().createElement(te.Modal,{isOpen:!0,onDismiss:this.dismiss,className:l.modal,title:w().createElement("div",{className:l.modalHeaderTitle},this.state.loading?w().createElement(te.Spinner,{size:18}):w().createElement(le,{icon:"terminal"}),"Execute script")},w().createElement(te.Select,{options:t,value:n,onChange:this.onChangeSelectedScript}),a&&w().createElement("small",{className:l.inputError},a),w().createElement("div",{className:l.scriptCommandContainer},r&&w().createElement("small",{className:l.scriptCommand},r.command)),w().createElement("div",{className:l.resultContainer},o&&w().createElement("span",{className:l.execResult},o),s&&w().createElement("span",{className:l.execError},i)),w().createElement(te.ButtonGroup,{className:l.buttonGroup},w().createElement(te.Button,{variant:"primary",onClick:this.submit},"Execute"),w().createElement(te.Button,{variant:"secondary",onClick:this.dismiss},"Cancel")))}constructor(e){super(e),Ke(this,"scripts",void 0),Ke(this,"onChangeSelectedScript",(e=>{const t=this.scripts.find((t=>e.value===t.scriptid));this.setState({selectedScript:e,script:t,errorMessage:"",loading:!1,result:""})})),Ke(this,"dismiss",(()=>{this.setState({selectedScript:null,error:!1,errorMessage:"",selectError:"",loading:!1}),this.props.onDismiss()})),Ke(this,"submit",(()=>{const{selectedScript:e}=this.state;if(!e)return this.setState({selectError:"Select a script to execute."});this.setState({errorMessage:"",loading:!0,result:""});const t={scriptid:e.value};this.props.onSubmit(t).then((e=>{var t,n;const r=this.formatResult((null===(t=e)||void 0===t?void 0:t.value)||"");"success"===(null===(n=e)||void 0===n?void 0:n.response)?this.setState({result:r,loading:!1}):this.setState({error:!0,errorMessage:r,loading:!1})})).catch((e=>{var t,n;let r=(null===(t=e.data)||void 0===t?void 0:t.message)||(null===(n=e.data)||void 0===n?void 0:n.error)||e.data||e.statusText||"";r=this.formatResult(r),this.setState({error:!0,loading:!1,errorMessage:r})}))})),Ke(this,"formatResult",(e=>{const t=e.split("\n").map(((e,t)=>w().createElement("p",{key:t},e)));return w().createElement(w().Fragment,null,t)})),this.state={error:!1,errorMessage:"",selectError:"",selectedScript:null,result:"",loading:!1,scriptOptions:[],script:null}}}const Ue=(0,te.stylesFactory)((e=>{const t=e.palette.red;return{modal:x.css`
      width: 600px;
    `,modalHeaderTitle:x.css`
      font-size: ${e.typography.heading.h3};
      padding-top: ${e.spacing.sm};
      margin: 0 ${e.spacing.md};
      display: flex;
    `,input:x.css`
      border-color: ${t};
      border-radius: 2px;
      outline-offset: 2px;
      box-shadow:
        0 0 0 2px ${e.colors.bg1},
        0 0 0px 4px ${t};
    `,scriptCommandContainer:x.css`
      margin-bottom: ${e.spacing.md};
    `,scriptCommand:x.css`
      color: ${e.colors.textWeak};
      text-align: left;
      font-family: ${e.typography.fontFamily.monospace};
    `,inputHint:x.css`
      display: inherit;
      float: right;
      color: ${e.colors.textWeak};
    `,inputError:x.css`
      float: left;
      color: ${t};
    `,resultContainer:x.css`
      min-height: 50px;
      font-family: ${e.typography.fontFamily.monospace};
      font-size: ${e.typography.size.sm};
      p {
        font-size: ${e.typography.size.sm};
        margin-bottom: 0px;
      }
    `,execResult:x.css``,execError:x.css`
      color: ${t};
    `,buttonGroup:x.css`
      justify-content: center;
      gap: ${e.spacing.sm};
      margin-top: ${e.spacing.md};
    `}})),Je=(0,te.withTheme)(Ve);function qe(e){const{problem:t,alerts:n,className:r}=e,o="1"===t.type,a=t.url&&""!==t.url,i=t.maintenance,s="1"===t.manual_close,l=t.error&&""!==t.error,c="1"===t.state,u="1"===t.correlation_mode,d=n&&0!==n.length,p=d?n[0].message:"";return w().createElement("div",{className:`problem-statusbar ${r||""}`},w().createElement(Ye,{icon:"wrench",fired:i,tooltip:"Host maintenance"}),w().createElement(Ye,{icon:"globe",fired:a,link:a&&t.url,tooltip:"External link"}),w().createElement(Ye,{icon:"bullhorn",fired:o,tooltip:"Trigger generates multiple problem events"}),w().createElement(Ye,{icon:"tag",fired:u,tooltip:`OK event closes problems matched to tag: ${t.correlation_tag}`}),w().createElement(Ye,{icon:"circle-o-notch",fired:d,tooltip:p}),w().createElement(Ye,{icon:"question-circle",fired:c,tooltip:"Current trigger state is unknown"}),w().createElement(Ye,{icon:"warning",fired:l,tooltip:t.error}),w().createElement(Ye,{icon:"window-close-o",fired:s,tooltip:"Manual close problem"}))}function Ye(e){const{fired:t,icon:n,link:r,tooltip:o}=e;let a=w().createElement("div",{className:"problem-statusbar-item "+(t?"fired":"muted")},w().createElement(ce,{icon:n}));return o&&t&&(a=w().createElement(te.Tooltip,{placement:"bottom",content:o},a)),r?w().createElement("a",{href:r,target:"_blank",rel:"noreferrer"},a):a}const Xe=({items:e})=>{const t=(0,te.useStyles2)(Ze);return w().createElement("div",{className:t.itemsRow},e.length>1?e.map((e=>w().createElement(Qe,{item:e,key:e.itemid,showName:!0}))):w().createElement(Qe,{item:e[0]}))},Qe=({item:e,showName:t})=>{const n=(0,te.useStyles2)(Ze),r=v(e.name,e.key_);return w().createElement("div",{className:n.itemContainer},w().createElement(le,{icon:"thermometer-three-quarters"}),t&&w().createElement("span",{className:n.itemName},e.name,": "),w().createElement(te.Tooltip,{placement:"top-start",content:()=>w().createElement(w().Fragment,null,r,w().createElement("br",null),e.lastvalue)},w().createElement("span",null,e.lastvalue)))},Ze=e=>({itemContainer:x.css`
    display: flex;
  `,itemName:x.css`
    color: ${e.colors.text.secondary};
  `,itemsRow:x.css`
    overflow: hidden;
  `}),et=({hosts:e})=>{const t=(0,te.useStyles2)(nt);return w().createElement(w().Fragment,null,e.map((e=>w().createElement("div",{className:t.hostContainer,key:e.hostid},w().createElement(le,{icon:"server"}),w().createElement("span",null,e.name)))))},tt=({hosts:e})=>{const t=(0,te.useStyles2)(nt);return w().createElement(w().Fragment,null,w().createElement("span",{className:t.label},"Host description: "),e.map(((e,t)=>w().createElement("span",{key:`${e.hostid}-${t}`},e.description))))},nt=e=>({hostContainer:x.css`
    margin-bottom: ${e.spacing(.2)};
  `,label:x.css`
    color: ${e.colors.text.secondary};
  `}),rt=({groups:e})=>{const t=(0,te.useStyles2)(ot);return w().createElement(w().Fragment,null,e.map((e=>w().createElement("div",{className:t.groupContainer,key:e.groupid},w().createElement(le,{icon:"folder"}),w().createElement("span",null,e.name)))))},ot=e=>({groupContainer:x.css`
    margin-bottom: ${e.spacing(.2)};
  `}),at=({problem:e})=>{const t=(0,te.useStyles2)(it);return w().createElement(w().Fragment,null,w().createElement(te.Tooltip,{placement:"right",content:e.expression},w().createElement("span",{className:t.label},"Expression: ")),w().createElement("span",{className:t.expression},e.expression))},it=e=>({label:x.css`
    color: ${e.colors.text.secondary};
  `,expression:x.css`
    font-family: ${e.typography.fontFamilyMonospace};
  `});function st(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function lt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){st(a,r,o,i,s,"next",e)}function s(e){st(a,r,o,i,s,"throw",e)}i(void 0)}))}}const ct=({original:e,rootWidth:t,timeRange:n,showTimeline:r,panelId:o,allowDangerousHTML:a,getProblemAlerts:i,getProblemEvents:s,getScripts:l,onExecuteScript:c,onProblemAck:u,onTagClick:d})=>{var p;const[m,h]=(0,E.useState)([]),[f,v]=(0,E.useState)([]),[b,y]=(0,E.useState)(!1);(0,E.useEffect)((()=>{r&&C(),S(),requestAnimationFrame((()=>{y(!0)}))}),[]);const C=(x=lt((function*(){const t=e,n=yield s(t);h(n)})),function(){return x.apply(this,arguments)});var x;const S=function(){var t=lt((function*(){const t=e,n=yield i(t);v(n)}));return function(){return t.apply(this,arguments)}}(),k=(e,t,n,r)=>{d&&d(e,t,n,r)},N=t=>u(e,t),T=()=>l(e),O=t=>c(e,t.scriptid),z=e,F=b?"show":"",D=t>1200,R=t<800||z.acknowledges&&D&&t<1400,M=g().unix(z.timestamp).fromNow(!0),j=z.acknowledges&&0!==z.acknowledges.length,H=Number(z.severity),A=(0,te.useStyles2)(ut);let $=e.datasource;(null===(p=e.datasource)||void 0===p?void 0:p.uid)&&($=(0,P.getDataSourceSrv)().getInstanceSettings(e.datasource.uid).name);const B=a?w().createElement("span",{dangerouslySetInnerHTML:{__html:z.comments}}):w().createElement("span",null,z.comments);return w().createElement("div",{className:`problem-details-container ${F}`},w().createElement("div",{className:"problem-details-body"},w().createElement("div",{className:A.problemDetails},w().createElement("div",{className:"problem-details-head"},w().createElement("div",{className:"problem-actions-left"},w().createElement(me,{problem:z,panelId:o,range:n})),z.showAckButton&&w().createElement("div",{className:"problem-actions"},w().createElement(xe,null,(({showModal:e,hideModal:t})=>w().createElement(ge,{className:"problem-action-button",onClick:()=>{e(Je,{getScripts:T,onSubmit:O,onDismiss:t})}}))),w().createElement(xe,null,(({showModal:e,hideModal:t})=>w().createElement(pe,{className:"problem-action-button",onClick:()=>{e(ze,{canClose:"1"===z.manual_close,severity:H,onSubmit:N,onDismiss:t})}})))),w().createElement(qe,{problem:z,alerts:f,className:R&&"compact"})),w().createElement("div",{className:"problem-details-row"},w().createElement("div",{className:"problem-value-container"},w().createElement("div",{className:"problem-age"},w().createElement(le,{icon:"clock-o"}),w().createElement("span",null,M)),z.items&&w().createElement(Xe,{items:z.items}))),z.comments&&w().createElement("div",{className:"problem-description-row"},w().createElement("div",{className:A.problemDescription},w().createElement(te.Tooltip,{placement:"right",content:B},w().createElement("span",{className:"description-label"},"Description: ")),B)),z.items&&w().createElement("div",null,w().createElement(at,{problem:z})),z.hosts&&w().createElement("div",null,w().createElement(tt,{hosts:z.hosts})),z.tags&&z.tags.length>0&&w().createElement("div",{className:"problem-tags"},z.tags&&z.tags.map((e=>w().createElement(ae,{key:e.tag+e.value,tag:e,datasource:z.datasource,highlight:e.tag===z.correlation_tag,onClick:k})))),r&&m.length>0&&w().createElement(je,{events:m,timeRange:n}),j&&!D&&w().createElement("div",{className:"problem-ack-container"},w().createElement("h6",null,w().createElement(le,{icon:"reply-all"})," Acknowledges"),w().createElement(Fe,{acknowledges:z.acknowledges}))),j&&D&&w().createElement("div",{className:"problem-details-middle"},w().createElement("div",{className:"problem-ack-container"},w().createElement("h6",null,w().createElement(le,{icon:"reply-all"})," Acknowledges"),w().createElement(Fe,{acknowledges:z.acknowledges}))),w().createElement("div",{className:"problem-details-right"},w().createElement("div",{className:"problem-details-right-item"},w().createElement(le,{icon:"database"}),w().createElement("span",null,$)),z.proxy&&w().createElement("div",{className:"problem-details-right-item"},w().createElement(le,{icon:"cloud"}),w().createElement("span",null,z.proxy)),z.groups&&w().createElement(rt,{groups:z.groups}),z.hosts&&w().createElement(et,{hosts:z.hosts}))))},ut=e=>({problemDetails:x.css`
    position: relative;
    flex: 10 1 auto;
    // padding: 0.5rem 1rem 0.5rem 1.2rem;
    padding: ${e.spacing(.5)} ${e.spacing(1)} ${e.spacing(.5)} ${e.spacing(1.2)};
    display: flex;
    flex-direction: column;
    // white-space: pre-line;
    font-size: ${e.typography.bodySmall.fontSize};
  `,problemDescription:x.css`
    position: relative;
    max-height: 6rem;
    min-height: 3rem;
    overflow: hidden;

    &:after {
      content: '';
      text-align: right;
      position: inherit;
      bottom: 0;
      right: 0;
      width: 70%;
      height: 1.5rem;
      background: linear-gradient(to right, rgba(0, 0, 0, 0), ${e.colors.background.canvas} 50%);
    }
  `}),dt=(0,te.stylesFactory)((e=>({countLabel:x.css`
      font-size: ${e.typography.size.sm};
    `}))),pt=e=>{var t,n;const r=e.original,o=(0,te.useTheme)(),a=dt(o);return w().createElement("div",null,(null===(t=r.acknowledges)||void 0===t?void 0:t.length)>0&&w().createElement(w().Fragment,null,w().createElement(le,{icon:"comments"}),w().createElement("span",{className:a.countLabel}," (",null===(n=r.acknowledges)||void 0===n?void 0:n.length,")")))};function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mt(e,t,n[t])}))}return e}function gt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class ft extends E.PureComponent{buildColumns(){const e=[],t=this.props.panelOptions,n=t.highlightNewEvents&&t.highlightNewerThan,r=[{Header:"Host",id:"host",show:t.hostField,Cell:e=>w().createElement(vt,{name:e.original.host,maintenance:e.original.hostInMaintenance})},{Header:"Host (Technical Name)",id:"hostTechName",show:t.hostTechNameField,Cell:e=>w().createElement(vt,{name:e.original.hostTechName,maintenance:e.original.hostInMaintenance})},{Header:"Host Groups",accessor:"groups",show:t.hostGroups,Cell:Et},{Header:"Proxy",accessor:"proxy",show:t.hostProxy},{Header:"Severity",show:t.severityField,className:"problem-severity",width:120,accessor:e=>e.priority,id:"severity",Cell:e=>function(e,t,n,r,o=bt){const a=e.original;let i,s;const l=Number(a.severity);return s=m().find(t,(e=>e.priority===l)),a.severity&&"1"===a.value&&(s=m().find(t,(e=>e.priority===l))),i="0"===a.value?o:s.color,n&&"1"===a.acknowledged&&(i=r),w().createElement("div",{className:"severity-cell",style:{background:i}},s.severity)}(e,t.triggerSeverity,t.markAckEvents,t.ackEventColor,t.okEventColor)},{Header:"",id:"statusIcon",show:t.statusIcon,className:"problem-status-icon",width:50,accessor:"value",Cell:e=>function(e,t){const n="0"===e.value?"ok":"problem";let r=!1;t&&(r=b(e.original,t));const o=(0,x.cx)("zbx-problem-status-icon",{"problem-status--new":r},{"zbx-problem":"1"===e.value},{"zbx-ok":"0"===e.value});return w().createElement(se,{status:n,className:o})}(e,n)},{Header:"Status",accessor:"value",show:t.statusField,width:100,Cell:e=>function(e,t){const n="0"===e.value?"RESOLVED":"PROBLEM",r="0"===e.value?bt:yt;let o=!1;return t&&(o=b(e.original,t)),w().createElement("span",{className:o?"problem-status--new":"",style:{color:r}},n)}(e,n)},{Header:"Problem",accessor:"name",minWidth:200,Cell:wt},{Header:"Operational data",accessor:"opdata",show:t.opdataField,width:150,Cell:Pt},{Header:"Ack",id:"ack",show:t.ackField,width:70,Cell:e=>w().createElement(pt,e)},{Header:"Tags",accessor:"tags",show:t.showTags,className:"problem-tags",Cell:e=>w().createElement(xt,gt(ht({},e),{onTagClick:this.handleTagClick}))},{Header:"Age",className:"problem-age",width:100,show:t.ageField,accessor:"timestamp",id:"age",Cell:Ct},{Header:"Time",className:"last-change",width:150,accessor:"timestamp",id:"lastchange",Cell:e=>function(e,t){const n=e.original,r=t||"DD MMM YYYY HH:mm:ss",o=g().unix(n.timestamp).format(r);return w().createElement("span",null,o)}(e,t.customLastChangeFormat&&t.lastChangeFormat)},{Header:"",className:"custom-expander",width:60,expander:!0,Expander:St}];for(const t of r)(t.show||void 0===t.show)&&(delete t.show,e.push(t));return e}render(){const e=this.buildColumns();this.rootWidth=this.rootRef&&this.rootRef.clientWidth;const{pageSize:t,fontSize:n,panelOptions:r}=this.props,o=(0,x.cx)("panel-problems",{[`font-size--${n}`]:!!n});let a=[5,10,20,25,50,100];return t&&(a.push(t),a=m().uniq(m().sortBy(a))),w().createElement("div",{className:o,ref:this.setRootRef},w().createElement(ee,{data:this.props.problems,columns:e,defaultPageSize:10,pageSize:t,pageSizeOptions:a,resized:r.resizedColumns,minRows:0,loading:this.props.loading,noDataText:"No problems found",SubComponent:e=>w().createElement(ct,gt(ht({},e),{rootWidth:this.rootWidth,timeRange:this.props.timeRange,showTimeline:r.problemTimeline,allowDangerousHTML:r.allowDangerousHTML,panelId:this.props.panelId,getProblemEvents:this.props.getProblemEvents,getProblemAlerts:this.props.getProblemAlerts,getScripts:this.props.getScripts,onProblemAck:this.handleProblemAck,onExecuteScript:this.props.onExecuteScript,onTagClick:this.handleTagClick,subRows:!1})),expanded:this.getExpandedPage(this.state.page),onExpandedChange:this.handleExpandedChange,onPageChange:e=>{(0,P.reportInteraction)("grafana_zabbix_panel_page_change",{action:e>this.state.page?"next":"prev"}),this.setState({page:e})},onPageSizeChange:this.handlePageSizeChange,onResizedChange:this.handleResizedChange}))}constructor(e){super(e),mt(this,"rootWidth",void 0),mt(this,"rootRef",void 0),mt(this,"setRootRef",(e=>{this.rootRef=e})),mt(this,"handleProblemAck",((e,t)=>this.props.onProblemAck(e,t))),mt(this,"onExecuteScript",((e,t)=>{})),mt(this,"handlePageSizeChange",((e,t)=>{this.props.onPageSizeChange&&this.props.onPageSizeChange(e,t)})),mt(this,"handleResizedChange",((e,t)=>{this.props.onColumnResize&&this.props.onColumnResize(e)})),mt(this,"handleExpandedChange",((e,t)=>{(0,P.reportInteraction)("grafana_zabbix_panel_row_expanded",{});const{problems:n,pageSize:r}=this.props,{page:o}=this.state,a={};for(const t in e){const i=r*o+Number(t);if(e[t]&&i<n.length){const e=n[i].eventid;e&&(a[e]=!0)}}const i=ht({},this.state.expanded);i[o]=e;const s=ht({},this.state.expandedProblems);s[o]=a,this.setState({expanded:i,expandedProblems:s})})),mt(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)})),mt(this,"getExpandedPage",(e=>{const{problems:t,pageSize:n}=this.props,{expandedProblems:r}=this.state,o=r[e]||{},a={},i=n*e,s=Math.min(i+n,t.length);for(let e=i;e<s;e++)o[t[e].eventid]&&(a[e-i]={});return a})),this.rootWidth=0,this.state={expanded:{},expandedProblems:{},page:0}}}const vt=({name:e,maintenance:t})=>w().createElement("div",null,w().createElement("span",{style:{paddingRight:"0.4rem"}},e),t&&w().createElement(le,{customClass:"fired",icon:"wrench"})),bt="rgb(56, 189, 113)",yt="rgb(215, 0, 0)";function Et(e){let t="";return e.value&&e.value.length&&(t=e.value.map((e=>e.name)).join(", ")),w().createElement("span",null,t)}function wt(e){return w().createElement("div",null,w().createElement("span",{className:"problem-description"},e.value))}function Pt(e){const t=e.original;return w().createElement("div",null,w().createElement("span",null,t.opdata))}function Ct(e){const t=e.original,n=g().unix(t.timestamp).fromNow(!0);return w().createElement("span",null,n)}class xt extends E.PureComponent{render(){return[(this.props.value||[]).map((e=>w().createElement(ae,{key:e.tag+e.value,tag:e,datasource:this.props.original.datasource,onClick:this.handleTagClick})))]}constructor(...e){super(...e),mt(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)}))}}function St(e){return w().createElement("span",{className:e.isExpanded?"expanded":""},w().createElement("i",{className:"fa fa-info-circle"}))}class kt extends E.PureComponent{render(){const{problem:e}=this.props,t=e.acknowledges&&e.acknowledges.map((e=>w().createElement("tr",{key:e.acknowledgeid},w().createElement("td",null,e.time),w().createElement("td",null,e.user),w().createElement("td",null,e.message))));return w().createElement("div",{className:"ack-tooltip"},w().createElement("table",{className:"table"},w().createElement("thead",null,w().createElement("tr",null,w().createElement("th",{className:"ack-time"},"Time"),w().createElement("th",{className:"ack-user"},"User"),w().createElement("th",{className:"ack-comments"},"Comments"))),w().createElement("tbody",null,t)),e.showAckButton&&w().createElement("div",{className:"ack-add-button"},w().createElement("button",{id:"add-acknowledge-btn",className:"btn btn-mini btn-inverse gf-form-button",onClick:this.handleClick},w().createElement("i",{className:"fa fa-plus"}))))}constructor(...e){super(...e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleClick",(e=>{this.props.onClick(e)}))}}const Nt=({problem:e,color:t,blink:n,highlightBackground:r})=>{const o=Number(e.severity),a="1"===e.value&&o>=2?"critical":"online",i=(0,x.cx)("icon-gf",n&&"zabbix-trigger--blinked"),s=(0,x.cx)("alert-rule-item__icon",!r&&x.css`
        color: ${t};
      `);return w().createElement("div",{className:s},w().createElement(se,{status:a,className:i}))};function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ot extends E.PureComponent{render(){var e;const{problem:t,panelOptions:n}=this.props,r=n.targets&&n.targets.length>1,o=(0,x.cx)("alert-rule-item","zbx-trigger-card",{"zbx-trigger-highlighted":n.highlightBackground}),a=(0,x.cx)("alert-rule-item__text",{"zbx-description--newline":n.descriptionAtNewLine}),i=Number(t.severity);let s;s=m().find(n.triggerSeverity,(e=>e.priority===i)),t.severity&&(s=m().find(n.triggerSeverity,(e=>e.priority===i)));const l=function(e,t){const n=new Date(1e3*e),r=t||"DD MMM YYYY HH:mm:ss";return c.dateMath.parse(n).format(r)}(t.timestamp,n.customLastChangeFormat&&n.lastChangeFormat),u=g().unix(t.timestamp).fromNow(!0);let d=t.datasource;if(null===(e=t.datasource)||void 0===e?void 0:e.uid){const e=(0,P.getDataSourceSrv)().getInstanceSettings(t.datasource.uid);d=e.name}let p=!1;n.highlightNewerThan&&(p=b(t,n.highlightNewerThan));const h=n.highlightNewEvents&&p;let f;f="0"===t.value?n.okEventColor:n.markAckEvents&&"1"===t.acknowledged?n.ackEventColor:s.color;const v={};return n.highlightBackground&&(v.backgroundColor=f),w().createElement("li",{className:o,style:v},w().createElement(Nt,{problem:t,color:f,highlightBackground:n.highlightBackground,blink:h}),w().createElement("div",{className:"alert-rule-item__body"},w().createElement("div",{className:"alert-rule-item__header"},w().createElement("div",{className:"alert-rule-item__name"},w().createElement("span",{className:"zabbix-trigger-name"},t.description),(n.hostField||n.hostTechNameField)&&w().createElement(zt,{problem:t,panelOptions:n}),n.hostGroups&&w().createElement(Ft,{problem:t,panelOptions:n}),n.showTags&&w().createElement("span",{className:"zbx-trigger-tags"},t.tags&&t.tags.map((e=>w().createElement(ae,{key:e.tag+e.value,tag:e,datasource:d,highlight:e.tag===t.correlation_tag,onClick:this.handleTagClick}))))),w().createElement("div",{className:a},n.statusField&&w().createElement(Mt,{problem:t,blink:h}),n.severityField&&w().createElement(jt,{severityDesc:s,blink:h,highlightBackground:n.highlightBackground}),w().createElement("span",{className:"alert-rule-item__time"},n.ageField&&"for "+u),n.descriptionField&&!n.descriptionAtNewLine&&w().createElement(w().Fragment,null,n.allowDangerousHTML?w().createElement("span",{className:"zbx-description",dangerouslySetInnerHTML:{__html:t.comments}}):w().createElement("span",{className:"zbx-description"},t.comments))),n.descriptionField&&n.descriptionAtNewLine&&w().createElement("div",{className:"alert-rule-item__text zbx-description--newline"},n.allowDangerousHTML?w().createElement("span",{className:"alert-rule-item__info zbx-description",dangerouslySetInnerHTML:{__html:t.comments}}):w().createElement("span",{className:"alert-rule-item__info zbx-description"},t.comments)))),r&&w().createElement("div",{className:"alert-rule-item__time zabbix-trigger-source"},w().createElement("span",null,w().createElement("i",{className:"fa fa-database"}),d)),w().createElement("div",{className:"alert-rule-item__time zbx-trigger-lastchange"},w().createElement("span",null,l||"last change unknown"),w().createElement("div",{className:"trigger-info-block zbx-status-icons"},t.url&&w().createElement("a",{href:t.url,target:"_blank",rel:"noreferrer"},w().createElement("i",{className:"fa fa-external-link"})),"1"===t.state&&w().createElement(te.Tooltip,{placement:"bottom",content:t.error},w().createElement("span",null,w().createElement("i",{className:"fa fa-question-circle"}))),t.eventid&&w().createElement(xe,null,(({showModal:e,hideModal:n})=>w().createElement(Ht,{problem:t,onClick:()=>{e(ze,{canClose:"1"===t.manual_close,severity:i,onSubmit:this.ackProblem,onDismiss:n})}}))))))}constructor(...e){super(...e),Tt(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)})),Tt(this,"ackProblem",(e=>{const t=this.props.problem;return this.props.onProblemAck(t,e)}))}}function zt(e){const t=e.problem,n=e.panelOptions;let r="";return n.hostField&&n.hostTechNameField?r=`${t.host} (${t.hostTechName})`:(n.hostField||n.hostTechNameField)&&(r=n.hostField?t.host:t.hostTechName),n.hostProxy&&t.proxy&&(r=`${t.proxy}: ${r}`),w().createElement("span",{className:"zabbix-hostname"},t.maintenance&&w().createElement("i",{className:"fa fa-wrench zbx-maintenance-icon"}),r)}function Ft(e){const t=e.problem;let n="";return e.panelOptions.hostGroups&&(n+=`[ ${m().map(t.groups,"name").join(", ")} ]`),w().createElement("span",{className:"zabbix-hostname"},n)}const Dt="rgb(56, 189, 113)",Rt="rgb(215, 0, 0)";function Mt(e){const{problem:t,okColor:n,problemColor:r,blink:o}=e,a="0"===t.value?"RESOLVED":"PROBLEM",i="0"===t.value?n||Dt:r||Rt,s=(0,x.cx)("zbx-trigger-state",{"alert-state-critical":"1"===t.value},{"alert-state-ok":"0"===t.value},{"zabbix-trigger--blinked":o});return w().createElement("span",{className:s,style:{color:i}},a)}function jt(e){const{severityDesc:t,highlightBackground:n,blink:r}=e,o=(0,x.cx)("zbx-trigger-severity",{"zabbix-trigger--blinked":r}),a={};return n||(a.color=t.color),w().createElement("span",{className:o,style:a},t.severity)}class Ht extends E.PureComponent{render(){const{problem:e}=this.props;let t=null;return e.acknowledges&&e.acknowledges.length?t=w().createElement(te.Tooltip,{placement:"auto",content:this.renderTooltipContent,interactive:!0},w().createElement("span",null,w().createElement("i",{className:"fa fa-comments"}))):e.showAckButton&&(t=w().createElement(te.Tooltip,{placement:"bottom",content:"Acknowledge problem"},w().createElement("span",{role:"button",onClick:this.handleClick},w().createElement("i",{className:"fa fa-comments-o"})))),t}constructor(...e){super(...e),Tt(this,"handleClick",(e=>{this.props.onClick(e)})),Tt(this,"renderTooltipContent",(()=>w().createElement(kt,{problem:this.props.problem,onClick:this.handleClick})))}}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $t extends E.PureComponent{getCurrentProblems(e){const{pageSize:t,problems:n}=this.props,r=t*e,o=Math.min(t*(e+1),n.length);return this.props.problems.slice(r,o)}render(){const{problems:e,panelOptions:t}=this.props,n=this.getCurrentProblems(this.state.page);let r=parseInt(t.fontSize.slice(0,t.fontSize.length-1),10);r=r&&100!==r?r:null;const o=(0,x.cx)("alert-rule-list",{[`font-size--${r}`]:!!r});return w().createElement("div",{className:"triggers-panel-container",key:"alertListContainer"},w().createElement("section",{className:"card-section card-list-layout-list"},w().createElement("ol",{className:o},n.map(((e,n)=>{var r;return w().createElement(Ot,{key:`${e.triggerid}-${e.eventid}-${(null===(r=e.datasource)||void 0===r?void 0:r.uid)||e.datasource}-${n}`,problem:e,panelOptions:t,onTagClick:this.handleTagClick,onProblemAck:this.handleProblemAck})})))),w().createElement("div",{className:"triggers-panel-footer",key:"alertListFooter"},w().createElement(Bt,{itemsLength:e.length,pageSize:this.props.pageSize,pageIndex:this.state.page,onPageChange:this.handlePageChange})))}constructor(e){super(e),At(this,"handlePageChange",(e=>{const t=this.getCurrentProblems(e);this.setState({page:e,currentProblems:t})})),At(this,"handleTagClick",((e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)})),At(this,"handleProblemAck",((e,t)=>this.props.onProblemAck(e,t))),this.state={page:0,currentProblems:this.getCurrentProblems(0)}}}class Bt extends E.PureComponent{render(){const{itemsLength:e,pageIndex:t,pageSize:n}=this.props,r=Math.ceil(e/n);if(1===r)return w().createElement("ul",null);const o=Math.max(t-3,0),a=Math.min(r,o+9),i=[];for(let e=o;e<a;e++){const n=(0,x.cx)("triggers-panel-page-link","pointer",{active:e===t}),r=e+1,o=w().createElement("li",{key:r.toString()},w().createElement("a",{className:n,onClick:this.handlePageChange(e)},r));i.push(o)}return w().createElement("ul",null,i)}constructor(...e){super(...e),At(this,"handlePageChange",(e=>()=>{this.props.onPageChange(e)}))}}function _t(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function It(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){_t(a,r,o,i,s,"next",e)}function s(e){_t(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Wt(e,t,n[t])}))}return e}function Gt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Kt={schemaVersion:8,hostField:!0,hostTechNameField:!1,hostProxy:!1,hostGroups:!1,showTags:!0,statusField:!0,statusIcon:!1,severityField:!0,ackField:!0,ageField:!1,opdataField:!1,descriptionField:!0,descriptionAtNewLine:!1,sortProblems:"lastchange",limit:void 0,layout:"table",fontSize:"100%",pageSize:10,problemTimeline:!0,highlightBackground:!1,highlightNewEvents:!1,highlightNewerThan:"1h",customLastChangeFormat:!1,lastChangeFormat:"",resizedColumns:[],allowDangerousHTML:!1,triggerSeverity:[{priority:0,severity:"Not classified",color:"rgb(108, 108, 108)",show:!0},{priority:1,severity:"Information",color:"rgb(120, 158, 183)",show:!0},{priority:2,severity:"Warning",color:"rgb(175, 180, 36)",show:!0},{priority:3,severity:"Average",color:"rgb(255, 137, 30)",show:!0},{priority:4,severity:"High",color:"rgb(255, 101, 72)",show:!0},{priority:5,severity:"Disaster",color:"rgb(215, 0, 0)",show:!0}],okEventColor:"rgb(56, 189, 113)",ackEventColor:"rgb(56, 219, 156)",markAckEvents:!1},Vt=({onChange:e})=>w().createElement(te.Button,{variant:"secondary",onClick:()=>e([])},"Reset columns");function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ut(e,t,n[t])}))}return e}function qt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Yt=({value:e,onChange:t})=>{const n=n=>{e.forEach(((t,r)=>{t.priority===n.priority&&(e[r]=n)})),t(e)};return w().createElement(w().Fragment,null,e.map(((e,t)=>w().createElement(Xt,{key:`${e.priority}-${t}`,value:e,onChange:e=>n(e)}))))},Xt=({value:e,onChange:t})=>w().createElement(te.VerticalGroup,null,w().createElement(te.InlineFieldRow,null,w().createElement(te.InlineField,{labelWidth:12},w().createElement(te.Input,{width:24,defaultValue:e.severity,onBlur:n=>{var r,o;const a=null===(o=n)||void 0===o||null===(r=o.currentTarget)||void 0===r?void 0:r.value;null!==a&&t(qt(Jt({},e),{severity:a}))}})),w().createElement(te.InlineLabel,{width:4},w().createElement(te.ColorPicker,{color:e.color,onChange:n=>t(qt(Jt({},e),{color:n}))})),w().createElement(te.InlineField,{label:"Show"},w().createElement(te.InlineSwitch,{value:e.show,onChange:()=>t(qt(Jt({},e),{show:!e.show}))}))));(0,P.loadPluginCss)({dark:"plugins/alexanderzobnin-zabbix-app/styles/dark.css",light:"plugins/alexanderzobnin-zabbix-app/styles/light.css"});const Qt=new c.PanelPlugin((e=>{const{data:t,options:n,timeRange:r,onOptionsChange:o}=e,{layout:a,showTriggers:i,triggerSeverity:s,sortProblems:l}=n,u=()=>{var e;const n=[];if(!(null===(e=t)||void 0===e?void 0:e.series))return[];for(const e of t.series)try{const t=e.fields[0].values;t.toArray&&n.push(...t.toArray())}catch(e){return console.log(e),[]}let r=m().cloneDeep(n);return r=r.map((e=>h(e))),r=d(r),r=p(r),r},d=e=>{let t=m().cloneDeep(e);return"unacknowledged"===i?t=t.filter((e=>!(e.acknowledges&&e.acknowledges.length))):"acknowledged"===i&&(t=t.filter((e=>e.acknowledges&&e.acknowledges.length))),t=t.filter((e=>{const t=void 0!==e.severity?Number(e.severity):Number(e.priority);return s[t].show})),t},p=e=>("priority"===l?e=m().orderBy(e,["severity","timestamp","eventid"],["desc","desc","desc"]):"lastchange"===l&&(e=m().orderBy(e,["timestamp","severity","eventid"],["desc","desc","desc"])),e),h=e=>{const t=m().cloneDeep(e);if(t.hosts&&t.hosts.length){const e=t.hosts[0];t.host=e.name,t.hostTechName=e.host,e.proxy&&(t.proxy=e.proxy)}return t.tags&&0===t.tags.length&&(t.tags=void 0),t.comments&&n.allowDangerousHTML&&(t.comments=t.comments.replace("\n","<br>")),t.lastchangeUnix=Number(t.lastchange),t},g=e=>{if(!e)return[];const t=m().map(e.split(","),(e=>e.trim()));return m().map(t,(e=>{const t=e.split(":");return{tag:t[0].trim(),value:t[1].trim()}}))},v=e=>m().map(e,(e=>`${e.tag}:${e.value}`)).join(", "),b=(y=It((function*(e){const t=[e.triggerid],n=Math.ceil(c.dateMath.parse(r.from).unix()),o=Math.ceil(c.dateMath.parse(r.to).unix());return(yield(0,P.getDataSourceSrv)().get(e.datasource)).zabbix.getEvents(t,n,o,[0,1],100)})),function(e){return y.apply(this,arguments)});var y;const E=function(){var e=It((function*(e){if(!e.eventid)return Promise.resolve([]);const t=[e.eventid];return(yield(0,P.getDataSourceSrv)().get(e.datasource)).zabbix.getEventAlerts(t)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=It((function*(e){var t;const n=(null===(t=e.hosts)||void 0===t?void 0:t.length)?e.hosts[0].hostid:null;return(yield(0,P.getDataSourceSrv)().get(e.datasource)).zabbix.getScripts([n])}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=It((function*(e,t){var n;const r=(null===(n=e.hosts)||void 0===n?void 0:n.length)?e.hosts[0].hostid:null;return(yield(0,P.getDataSourceSrv)().get(e.datasource)).zabbix.executeScript(r,t)}));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=It((function*(e,t){const{message:n,action:r,severity:o}=t,a=e.eventid,i=C.contextSrv.user.name+" (Grafana): "+n,s=yield(0,P.getDataSourceSrv)().get(e.datasource),l=C.contextSrv.isEditor||C.contextSrv.isGrafanaAdmin;return s.disableReadOnlyUsersAck&&!l?{message:"You have no permissions to acknowledge events."}:a?s.zabbix.acknowledgeEvent(a,i,r,o):{message:"Trigger has no events. Nothing to acknowledge."}}));return function(t,n){return e.apply(this,arguments)}}(),N=(e,t)=>{o(Gt(Lt({},n),{pageSize:e}))},T=e=>{o(Gt(Lt({},n),{resizedColumns:e}))},O=(n,r,o,a)=>{o||a?((n,r)=>{var o;const a=e=>e.tag===n.tag&&e.value===n.value,i=null===(o=t.request)||void 0===o?void 0:o.targets;let s=!1;for(const e of i){var l,c;if((null===(l=e.datasource)||void 0===l?void 0:l.uid)===(null===(c=r)||void 0===c?void 0:c.uid)||e.datasource===r){var u;const t=null===(u=e.tags)||void 0===u?void 0:u.filter;let n=g(t);m().remove(n,a),n=m().uniqWith(n,m().isEqual);const r=v(n);e.tags.filter=r,s=!0}}if(s){const t=new f(i);e.eventBus.publish(t)}})(n,r):((n,r)=>{var o;const a=null===(o=t.request)||void 0===o?void 0:o.targets;let i=!1;for(const e of a){var s,l;if((null===(s=e.datasource)||void 0===s?void 0:s.uid)===(null===(l=r)||void 0===l?void 0:l.uid)||e.datasource===r){var c;const t=null===(c=e.tags)||void 0===c?void 0:c.filter;let r=g(t);const o={tag:n.tag,value:n.value};r.push(o),r=m().uniqWith(r,m().isEqual);const a=v(r);e.tags.filter=a,i=!0}}if(i){const t=new f(a);e.eventBus.publish(t)}})(n,r)};return w().createElement(w().Fragment,null,"list"===a&&(()=>{const e=u(),t=parseInt(n.fontSize.slice(0,n.fontSize.length-1),10),r=t&&100!==t?t:void 0;return w().createElement($t,{problems:e,panelOptions:n,pageSize:n.pageSize,fontSize:r,onProblemAck:k,onTagClick:O})})(),"table"===a&&(()=>{const e=u(),t=parseInt(n.fontSize.slice(0,n.fontSize.length-1),10),o=t&&100!==t?t:void 0;return w().createElement(ft,{problems:e,panelOptions:n,pageSize:n.pageSize,fontSize:o,timeRange:r,getProblemEvents:b,getProblemAlerts:E,getScripts:x,onExecuteScript:S,onProblemAck:k,onColumnResize:T,onPageSizeChange:N,onTagClick:O})})())})).setPanelChangeHandler(((e,t,n)=>{var r;return null!==(r=e.options)&&void 0!==r?r:{}})).setMigrationHandler((e=>{var t,n;let r=null!==(n=e.options)&&void 0!==n?n:{};var o;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){y(e,t,n[t])}))}return e}({},{layout:e.layout,hostField:e.hostField,hostTechNameField:e.hostTechNameField,hostGroups:e.hostGroups,hostProxy:e.hostProxy,showTags:e.showTags,statusField:e.statusField,statusIcon:e.statusIcon,severityField:e.severityField,ackField:e.ackField,ageField:e.ageField,descriptionField:e.descriptionField,descriptionAtNewLine:e.descriptionAtNewLine,hostsInMaintenance:e.hostsInMaintenance,showTriggers:e.showTriggers,sortProblems:e.sortProblems,limit:e.limit,fontSize:e.fontSize,pageSize:e.pageSize,problemTimeline:e.problemTimeline,highlightBackground:e.highlightBackground,highlightNewEvents:e.highlightNewEvents,highlightNewerThan:e.highlightNewerThan,customLastChangeFormat:e.customLastChangeFormat,lastChangeFormat:e.lastChangeFormat,resizedColumns:e.resizedColumns,triggerSeverity:e.triggerSeverity,okEventColor:e.okEventColor,ackEventColor:e.ackEventColor,markAckEvents:e.markAckEvents,showEvents:null!==(o=null===(t=e.showEvents)||void 0===t?void 0:t.value)&&void 0!==o?o:e.showEvents},r)})).setPanelOptions((e=>{e.addSelect({path:"layout",name:"Layout",defaultValue:Kt.layout,settings:{options:[{label:"Table",value:"table"},{label:"List",value:"list"}]}}).addSelect({path:"sortProblems",name:"Sort by",defaultValue:Kt.sortProblems,settings:{options:[{label:"Default",value:"default"},{label:"Last change",value:"lastchange"},{label:"Severity",value:"priority"}]}}).addSelect({path:"fontSize",name:"Font size",defaultValue:Kt.fontSize,settings:{options:Zt}}).addNumberInput({path:"pageSize",name:"Page size",defaultValue:Kt.pageSize}).addBooleanSwitch({path:"problemTimeline",name:"Problem timeline",defaultValue:Kt.problemTimeline,showIf:e=>"table"===e.layout}).addBooleanSwitch({path:"highlightBackground",name:"Highlight background",defaultValue:Kt.highlightBackground,showIf:e=>"list"===e.layout}).addBooleanSwitch({path:"highlightNewEvents",name:"Highlight new events",defaultValue:Kt.highlightNewEvents}).addTextInput({path:"highlightNewerThan",name:"Newer than",defaultValue:Kt.highlightNewerThan,showIf:e=>e.highlightNewEvents}).addBooleanSwitch({path:"customLastChangeFormat",name:"Custom last change format",defaultValue:Kt.customLastChangeFormat}).addTextInput({path:"lastChangeFormat",name:"Last change format",defaultValue:Kt.lastChangeFormat,description:"See moment.js dosc for time format http://momentjs.com/docs/#/displaying/format/",settings:{placeholder:"dddd, MMMM Do YYYY, h:mm:ss a"},showIf:e=>e.customLastChangeFormat}).addBooleanSwitch({path:"allowDangerousHTML",name:"Allow HTML",description:"Format problem description and other data as HTML. Use with caution, it's potential cross-site scripting (XSS) vulnerability.",defaultValue:Kt.allowDangerousHTML}).addCustomEditor({id:"resetColumns",path:"resizedColumns",name:"Reset resized columns",editor:Vt,showIf:e=>"table"===e.layout}).addCustomEditor({id:"triggerColors",path:"triggerSeverity",name:"Problem colors",editor:Yt,defaultValue:Kt.triggerSeverity,category:["Colors"]}).addBooleanSwitch({path:"markAckEvents",name:"Mark acknowledged events",defaultValue:Kt.markAckEvents,category:["Colors"]}).addColorPicker({path:"ackEventColor",name:"Acknowledged color",defaultValue:Kt.ackEventColor,showIf:e=>e.markAckEvents,settings:[{enableNamedColors:!1}],category:["Colors"]}).addColorPicker({path:"okEventColor",name:"OK event color",defaultValue:Kt.okEventColor,settings:[{enableNamedColors:!1}],category:["Colors"]}).addBooleanSwitch({path:"hostField",name:"Host name",defaultValue:Kt.hostField,category:["Fields"]}).addBooleanSwitch({path:"hostTechNameField",name:"Technical name",defaultValue:Kt.hostTechNameField,category:["Fields"]}).addBooleanSwitch({path:"hostGroups",name:"Host groups",defaultValue:Kt.hostGroups,category:["Fields"]}).addBooleanSwitch({path:"hostProxy",name:"Host proxy",defaultValue:Kt.hostProxy,category:["Fields"]}).addBooleanSwitch({path:"showTags",name:"Tags",defaultValue:Kt.showTags,category:["Fields"]}).addBooleanSwitch({path:"statusField",name:"Status",defaultValue:Kt.statusField,category:["Fields"]}).addBooleanSwitch({path:"statusIcon",name:"Status icon",defaultValue:Kt.statusIcon,category:["Fields"]}).addBooleanSwitch({path:"severityField",name:"Severity",defaultValue:Kt.severityField,category:["Fields"]}).addBooleanSwitch({path:"ackField",name:"Ack",defaultValue:Kt.ackField,category:["Fields"]}).addBooleanSwitch({path:"ageField",name:"Age",defaultValue:Kt.ageField,category:["Fields"]}).addBooleanSwitch({path:"opdataField",name:"Operational data",defaultValue:Kt.opdataField,category:["Fields"]}).addBooleanSwitch({path:"descriptionField",name:"Description",defaultValue:Kt.descriptionField,showIf:e=>"list"===e.layout,category:["Fields"]}).addBooleanSwitch({path:"descriptionAtNewLine",name:"At the new line",defaultValue:Kt.descriptionAtNewLine,showIf:e=>"list"===e.layout,category:["Fields"]})})),Zt=[{label:"80%",value:"80%"},{label:"90%",value:"90%"},{label:"100%",value:"100%"},{label:"110%",value:"110%"},{label:"120%",value:"120%"},{label:"130%",value:"130%"},{label:"150%",value:"150%"},{label:"160%",value:"160%"},{label:"180%",value:"180%"},{label:"200%",value:"200%"},{label:"220%",value:"220%"},{label:"250%",value:"250%"}]})(),p})()));
//# sourceMappingURL=module.js.map